"use strict";var an=Object.create;var we=Object.defineProperty;var dn=Object.getOwnPropertyDescriptor;var ln=Object.getOwnPropertyNames;var cn=Object.getPrototypeOf,un=Object.prototype.hasOwnProperty;var J=(p,e)=>()=>(p&&(e=p(p=0)),e);var pn=(p,e)=>()=>(e||p((e={exports:{}}).exports,e),e.exports),mn=(p,e)=>{for(var t in e)we(p,t,{get:e[t],enumerable:!0})},Bt=(p,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of ln(e))!un.call(p,o)&&o!==t&&we(p,o,{get:()=>e[o],enumerable:!(n=dn(e,o))||n.enumerable});return p};var ee=(p,e,t)=>(t=p!=null?an(cn(p)):{},Bt(e||!p||!p.__esModule?we(t,"default",{value:p,enumerable:!0}):t,p)),fn=p=>Bt(we({},"__esModule",{value:!0}),p);function et(){if(Ze===void 0)throw new Error("tsserverlibrary not loaded yet");return Ze}var Ze,N,H=J(()=>{"use strict";(e=>{function p(t){Ze=t}e.install=p})(et||={});N=et});var yn,hn,Sn,tt,nt,it,ot,rt,X,be,bn,W=J(()=>{"use strict";(e=>{function p(t){return t.cache!==void 0}e.has=p})(yn||={});(e=>{function p(t,n,o,r){return Object.freeze({emitMode:t,scope:r,startOffset:n,endOffset:o})}e.create=p})(hn||={});(e=>{function p(t,n,o){return{key:t,emitMode:n,sizeInChars:o}}e.create=p})(Sn||={});(e=>{function p(t,n){return{kind:"metaData",completionContext:t,path:n}}e.create=p})(tt||={});(e=>{function p(t,n){return{kind:"errorData",code:t,message:n}}e.create=p})(nt||={});(e=>{function p(t,n){return{kind:"timings",totalTime:t,computeTime:n}}e.create=p})(it||={});(e=>{function p(t,n){return{kind:"cachedItem",key:t,emitMode:n}}e.create=p})(ot||={});(e=>{function p(t,n){return{kind:"computationState",key:t,scope:n}}e.create=p})(rt||={});(n=>{function p(o,r,d,a,u){if(u===void 0)return{kind:"trait",traitKind:o,priority:r,name:d,value:a,speculativeKind:"emit"};{let l={key:t(o),emitMode:"clientBased",scope:{kind:"file"}};return{kind:"trait",traitKind:o,priority:r,name:d,value:a,speculativeKind:"emit",cache:l}}}n.create=p;function e(o){return o.name.length+o.value.length}n.sizeInChars=e;function t(o){return JSON.stringify({k:"trait",tk:o},void 0,0)}n.makeContextItemKey=t})(X||={});(t=>{function p(n,o,r,d,a,u,l){return{kind:"snippet",snippetKind:d,uri:n,additionalUris:o,value:r,priority:a,speculativeKind:u,cache:l}}t.create=p;function e(n){let o=n.value.length;if(o+=n.uri.length+3,n.additionalUris!==void 0)for(let r of n.additionalUris)o+=r.length+3;return o}t.sizeInChars=e})(be||={});(n=>{function p(o){return o.type==="cancelled"}n.isCancelled=p;function e(o){return o.type==="response"&&o.body.items!==void 0}n.isOk=e;function t(o){return o.type==="response"&&o.body.error!==void 0}n.isError=t})(bn||={})});var te=pn((Dn,_t)=>{"use strict";H();var i=N(),st=function*(){}(),qt;(O=>{let p=i;O.getTokenAtPosition=p.getTokenAtPosition,O.getTouchingToken=p.getTouchingToken,O.getNameTable=p.getNameTable,O.findReferencedSymbols=p.findReferencedSymbols,O.getSymbolId=p.getSymbolId;function d(w,s){let c=O.getTokenAtPosition(w,s);if(c.kind===i.SyntaxKind.EndOfFileToken){let y=c,m=s;for(;y.kind===i.SyntaxKind.EndOfFileToken&&m>0;)y=O.getTokenAtPosition(w,--m);return y.kind===i.SyntaxKind.EndOfFileToken?{token:c}:{previous:y,token:c}}let f={token:c},h=!0;if(s>c.getStart(w))f.touching=c,h=!1;else if(s<c.getStart(w)){let y=c.parent;for(;y!==void 0;){if(s>=y.getStart(w)){f.touching=y;break}y=y.parent}}if(h){let y=c;for(;y.parent;){let m=a(y.parent,w),g=u(m,y);if(g>0){let C=m[g-1],T=a(C,w);for(;T.length>0;){let K=T[T.length-1];if(K.kind===i.SyntaxKind.EndOfFileToken)break;C=K,T=a(C,w)}if(C.kind!==i.SyntaxKind.EndOfFileToken){f.previous=C;break}}y=y.parent}}return f}O.getRelevantTokens=d;function a(w,s){if(i.isSourceFile(w)){let c=w.getChildren(s);return c.length>0&&c[0].kind===i.SyntaxKind.SyntaxList?c[0].getChildren(s):w.statements}else return w.getChildren(s)}O.getChildren=a;function u(w,s){let c=0,f=w.length-1;for(;c<=f;){let h=Math.floor((c+f)/2),y=w[h].getStart(),m=s.getStart();if(y===m)return w[h]===s?h:-1;y<m?c=h+1:f=h-1}return-1}let l;(s=>{function w(c){let f=c.getCompilerOptions();if(typeof f.project=="string")return f.project;let h=f.configFilePath;return typeof h=="string"?h:void 0}s.getKey=w})(l=O.Programs||={});class b{cancellationToken;end;constructor(s,c,f,h=!1){this.cancellationToken=h?void 0:s,this.end=h?Number.MAX_VALUE:c+f}isCancellationRequested(){return this.cancellationToken&&this.cancellationToken.isCancellationRequested()?!0:Date.now()>this.end}isTimedOut(){return Date.now()>this.end}throwIfCancellationRequested(){if(this.isCancellationRequested())throw new i.OperationCanceledException}}O.CancellationTokenWithTimer=b;class S{isCancellationRequested(){return!1}throwIfCancellationRequested(){}}O.NullCancellationToken=S;let x;(f=>{function w(h){return h.symbol}f.getSymbol=w;function s(h){if(i.isTypeReferenceNode(h))return h.typeName.getText()}f.getTypeName=s;function c(h,y){let m=h;for(;m!==void 0;){if(m.kind===y)return m;m=m.parent}}f.getParentOfKind=c})(x=O.Nodes||={});let v;(s=>{function w(c){return(i.getCombinedModifierFlags(c)&i.ModifierFlags.Private)!==0}s.isPrivate=w})(v=O.Declarations||={});let D;(h=>{let w;(m=>m[m.topLevel=0]="topLevel")(w=h.Mode||={});function s(y){let m=y.kind;return m===i.SyntaxKind.InterfaceDeclaration||m===i.SyntaxKind.ClassDeclaration}h.is=s;function c(y,m=0){return f(y.statements)}h.entries=c;function*f(y){for(let m of y)i.isClassDeclaration(m)||i.isInterfaceDeclaration(m)?yield m:i.isModuleDeclaration(m)&&m.body!==void 0&&i.isModuleBlock(m.body)&&(yield*f(m.body.statements))}})(D=O.TypeDeclarations||={});let V;(h=>{function w(y){let m=y.heritageClauses;if(m!==void 0)return m.find(g=>g.token===i.SyntaxKind.ExtendsKeyword)}h.getExtendsClause=w;function s(y){return c(y.statements)}h.entries=s;function*c(y){for(let m of y)i.isClassDeclaration(m)?yield m:i.isModuleDeclaration(m)&&m.body!==void 0&&i.isModuleBlock(m.body)&&(yield*c(m.body.statements))}function f(y){if(!F.isClass(y))return;let m=y.getDeclarations();if(m!==void 0){for(let g of m)if(i.isClassDeclaration(g))return g}}h.fromSymbol=f})(V=O.ClassDeclarations||={});let Q;(h=>{function w(y){return(y.flags&i.TypeFlags.Intersection)!==0}h.isIntersection=w;function s(y){return(y.flags&i.TypeFlags.Union)!==0}h.isUnion=s;function c(y){return y.getBaseTypes()}h.getBaseTypes=c;function f(y,m){let g=m.getSymbol();if(g===void 0)return;let C=g.getDeclarations();if(C===void 0)return;let T=[];for(let K of C)if(i.isClassDeclaration(K)){let P=K.heritageClauses;if(P!==void 0)for(let _ of P)for(let oe of _.types)T.push(y.getTypeAtLocation(oe.expression))}return T}h.getExtendsTypes=f})(Q=O.Types||={});let q;(c=>(c.depthFirst="depthFirst",c.breadthFirst="breadthFirst"))(q=O.Traversal||={});let Y;(s=>s.breadthFirstOnly="breadthFirstOnly")(Y||={});class ke{start;mode;symbols;constructor(s,c,f){this.start=s,this.mode=c,this.symbols=f}isValid(){return F.isClass(this.start)}isValidDeclaration(s){return i.isClassDeclaration(s)}*getDeclarations(s){yield*V.entries(s)}isSubType(s,c){return this.symbols.isSubClass(s,c)}with(s){return new ke(s,this.mode,this.symbols)}}class Fe{start;mode;symbols;constructor(s,c,f){this.start=s,this.mode=c,this.symbols=f}isValid(){return F.isClass(this.start)||F.isInterface(this.start)||F.isTypeAlias(this.start)}isValidDeclaration(s){return D.is(s)||i.isTypeAliasDeclaration(s)}*getDeclarations(s){yield*D.entries(s,0)}isSubType(s,c){return this.symbols.isSubType(s,c)}with(s){return new Fe(s,this.mode,this.symbols)}}class F{program;typeChecker;constructor(s){this.program=s,this.typeChecker=s.getTypeChecker()}static Unknown="unknown";static Undefined="undefined";static None="none";static getParent(s){return s.parent}static isConstructor(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.Constructor)!==0}static isGetAccessor(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.GetAccessor)!==0}static isSetAccessor(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.SetAccessor)!==0}static isMethod(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.Method)!==0}static isProperty(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.Property)!==0}static isClass(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.Class)!==0}static isObjectLiteral(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.ObjectLiteral)!==0}static isInterface(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.Interface)!==0}static isTypeAlias(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.TypeAlias)!==0}static isTypeLiteral(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.TypeLiteral)!==0}static isAlias(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.Alias)!==0}static isFunction(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.Function)!==0}static isValueModule(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.ValueModule)!==0}static isEnum(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.Enum)!==0}static isRegularEnum(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.RegularEnum)!==0}static isConstEnum(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.ConstEnum)!==0}static isSignature(s){return s!==void 0&&(s.getFlags()&i.SymbolFlags.Signature)!==0}static hasModifierFlags(s,c){let f=s.declarations;if(f!==void 0){for(let h of f)if((i.getCombinedModifierFlags(h)&c)===0)return!1}return!0}static isAbstract(s){return this.hasModifierFlags(s,i.ModifierFlags.Abstract)}static isStatic(s){return this.hasModifierFlags(s,i.ModifierFlags.Static)}static isPrivate(s){return this.hasModifierFlags(s,i.ModifierFlags.Private)}static internalSymbolNames;static isInternal(s){if(this.internalSymbolNames===void 0){this.internalSymbolNames=new Set;for(let c in i.InternalSymbolName)this.internalSymbolNames.add(i.InternalSymbolName[c])}return this.internalSymbolNames.has(s.escapedName)}static isSourceFile(s){let c=s.getDeclarations();return c!==void 0&&c.length===1&&i.isSourceFile(c[0])}static fillSources(s,c){if(c.declarations!==void 0)for(let f of c.declarations){let h=f.getSourceFile();h!==void 0&&s.add(h.fileName)}}static getPrimarySourceFile(s){let c=s.declarations;if(!(c===void 0||c.length===0))return c[0].getSourceFile()}static getDeclaration(s,c){let f=s.getDeclarations();if(!(f===void 0||f.length===0)){for(let h of f)if(h.kind===c)return h}}static createKey(s,c){let f=s.getDeclarations();if(f===void 0)return;let h=[];for(let m of f){let g=m.getSourceFile();h.push({f:g.fileName,s:m.getStart(),e:m.getEnd(),k:m.kind})}h.length>1&&h.sort((m,g)=>{let C=m.f<g.f?-1:m.f>g.f?1:0;return C!==0||(C=m.s-g.s,C!==0)||(C=m.e-g.e,C!==0)?C:m.k-g.k});let y=c.createHash("md5");return(s.flags&i.SymbolFlags.Transient)!==0&&y.update(JSON.stringify({trans:!0},void 0,0)),y.update(JSON.stringify(h,void 0,0)),y.digest("base64")}static createVersionedKey(s,c,f){let h=s.getDeclarations();if(h===void 0)return;let y=[];for(let g of h){let C=g.getSourceFile(),T=c.getScriptVersion(C);if(T===void 0)return;y.push({f:C.fileName,v:T,s:g.getStart(),e:g.getEnd(),k:g.kind})}y.length>1&&y.sort((g,C)=>{let T=g.f<C.f?-1:g.f>C.f?1:0;return T!==0||(T=g.v<C.v?-1:g.v>C.v?1:0,T!==0)||(T=g.s-C.s,T!==0)||(T=g.e-C.e,T!==0)?T:g.k-C.k});let m=f.createHash("md5");return(s.flags&i.SymbolFlags.Transient)!==0&&m.update(JSON.stringify({trans:!0},void 0,0)),m.update(JSON.stringify(y,void 0,0)),m.digest("base64")}getFullyQualifiedSymbolName(s){let c=s.getDeclarations();if(c===void 0||c.length===0)return;let f=c[0].getSourceFile();for(let m=1;m<c.length;m++)if(c[m].getSourceFile()!==f)return;if(this.getSymbolAtLocation(f)===void 0)return;let h=[],y=s;for(;y!==void 0;){let m=y.declarations;if(m===void 0||m.length===0)return;if(m.length===1&&i.isSourceFile(m[0]))break;h.push(this.getExportSymbolName(y)),y=F.getParent(y)}return h.length===0?void 0:`${h.reverse().join(".")}`}static escapeRegExp=new RegExp("\\.","g");getExportSymbolName(s){let c=s.getEscapedName();return(c.charAt(0)==='"'||c.charAt(0)==="'")&&(c=c.substr(1,c.length-2)),c=c.replace(F.escapeRegExp,".."),c}getProgram(){return this.program}getTypeChecker(){return this.typeChecker}getSymbolAtLocation(s){let c=this.typeChecker.getSymbolAtLocation(s);return c===void 0&&(c=x.getSymbol(s)),c}getExtendsSymbol(s){let c=s.declarations;if(c===void 0)return[void 0,void 0];for(let f of c)if(i.isClassDeclaration(f)){let h=f.heritageClauses;if(h!==void 0){for(let y of h)if(y.token===i.SyntaxKind.ExtendsKeyword){let m=y.types[0]?.expression,g=this.typeChecker.getSymbolAtLocation(m);if(F.isAlias(g)&&(g=this.typeChecker.getAliasedSymbol(g)),F.isClass(g))return[g,m.getText()]}}}return[void 0,void 0]}getLeafSymbolAtLocation(s){let c=this.getSymbolAtLocation(s);if(c!==void 0)return F.isAlias(c)?this.typeChecker.getAliasedSymbol(c):c}getSymbolAtTypeNodeLocation(s){return i.isTypeReferenceNode(s)?this.getLeafSymbolAtLocation(s.typeName):i.isTypeLiteralNode(s)?this.getLeafSymbolAtLocation(s):this.getLeafSymbolAtLocation(s)}getAliasedSymbol(s){return this.typeChecker.getAliasedSymbol(s)}getLeafAliasedSymbol(s){let c=0;for(;F.isAlias(s)&&c++<10;)s=this.getAliasedSymbol(s);return s}getAllSuperTypes(s,c="depthFirst"){return this._getAllSuperTypes(s,c,new Set,!1)}getAllSuperTypesWithPath(s,c="depthFirst"){return this._getAllSuperTypes(s,c,new Set,!0)}getDirectSuperTypes(s){return this._getAllSuperTypes(s,"breadthFirstOnly",new Set,!1)}*_getAllSuperTypes(s,c,f,h){let y=[s];for(;y.length>0;){let m=y.pop();if(F.isAlias(m)&&(f.add(m),m=this.typeChecker.getAliasedSymbol(m)),F.isClass(m)||F.isInterface(m)){let g=m.declarations;if(g===void 0)return;for(let C of g){let T;if((i.isClassDeclaration(C)||i.isInterfaceDeclaration(C))&&(T=C.heritageClauses),T!==void 0)for(let K of T)for(let P of K.types){let _=this.getLeafSymbolAtLocation(P.expression);_!==void 0&&!f.has(_)&&(f.add(_),yield h?[m,_]:_,c==="depthFirst"?yield*this._getAllSuperTypes(_,c,f,h):c==="breadthFirst"&&y.push(_))}}}else if(F.isTypeAlias(m)){let g=m.declarations;if(g===void 0)return;for(let C of g)if(i.isTypeAliasDeclaration(C)){let T=C.type;if(i.isTypeLiteralNode(T)){let K=this.getSymbolAtLocation(T);K!==void 0&&!f.has(K)&&(f.add(K),yield h?[m,K]:K)}else if(i.isTypeReferenceNode(T)){let K=this.getLeafSymbolAtLocation(T.typeName);K!==void 0&&!f.has(K)&&(f.add(K),yield h?[m,K]:K,c==="depthFirst"?yield*this._getAllSuperTypes(K,c,f,h):c==="breadthFirst"&&y.push(K))}else if(i.isIntersectionTypeNode(T))for(let K of T.types){let P=this.getSymbolAtTypeNodeLocation(K);P!==void 0&&!f.has(P)&&(F.isTypeLiteral(P)?(f.add(P),yield h?[m,P]:P):F.isTypeAlias(P)?(f.add(P),c==="depthFirst"?yield*this._getAllSuperTypes(P,c,f,h):c==="breadthFirst"&&y.push(P)):(f.add(P),yield h?[m,P]:P,c==="depthFirst"?yield*this._getAllSuperTypes(P,c,f,h):c==="breadthFirst"&&y.push(P)))}}}}}getAllSuperClasses(s){return this._getAllSuperClasses(s,new Set)}*_getAllSuperClasses(s,c){if(!F.isClass(s))return;let f=[s];for(;f.length>0;){let y=f.pop().declarations;if(y!==void 0)for(let m of y){if(!i.isClassDeclaration(m))continue;let g=m.heritageClauses;if(g!==void 0)for(let C of g){if(C.token!==i.SyntaxKind.ExtendsKeyword||C.types.length<1)continue;let T=C.types[0],K=this.getLeafSymbolAtLocation(T.expression);K!==void 0&&!c.has(K)&&(c.add(K),yield K,f.push(K))}}}}isSubType(s,c){if(s.heritageClauses===void 0)return!1;for(let f of s.heritageClauses)for(let h of f.types){let y=this.getLeafSymbolAtLocation(h.expression);if(y!==void 0&&y===c)return!0}return!1}isSubClass(s,c){if(s.heritageClauses===void 0)return!1;for(let f of s.heritageClauses){if(f.token!==i.SyntaxKind.ExtendsKeyword)continue;if(f.types.length<1)return!1;let h=this.getLeafSymbolAtLocation(f.types[0].expression);if(h!==void 0&&h===c)return!0}return!1}getDirectSubTypes(s,c,f,h){let y=F.isClass(s)?new ke(s,"breadthFirstOnly",this):F.isInterface(s)||F.isTypeAlias(s)?new Fe(s,"breadthFirstOnly",this):void 0;return y===void 0?st:this._getAllSubTypes(y,c,f,new Set,h)}getAllSubTypes(s,c="depthFirst",f,h,y){let m=F.isClass(s)?new ke(s,c,this):F.isInterface(s)||F.isTypeAlias(s)?new Fe(s,c,this):void 0;return m===void 0?st:this._getAllSubTypes(m,f,h,new Set,y)}*_getAllSubTypes(s,c,f,h,y){if(!s.isValid())return;let m=[s.start];for(;m.length>0;){let g=m.pop(),C=g.declarations;if(C===void 0||C.length===0)return;for(let T of C){if(!s.isValidDeclaration(T))continue;let K=new rn(this.program,T.getSourceFile(),c,f,y);for(let P of K)for(let _ of s.getDeclarations(P)){let oe=this.getLeafSymbolAtLocation(_.name?_.name:_);oe===void 0||h.has(oe)||s.isSubType(_,g)&&(h.add(oe),yield oe,s.mode==="depthFirst"?yield*this._getAllSubTypes(s.with(oe),c,f,h,y):s.mode==="breadthFirst"&&m.push(oe))}}}}getMemberStatistic(s){let c=new Set,f=new Set;F._getMemberStatistic(c,f,s);for(let h of this.getAllSuperTypes(s))F._getMemberStatistic(c,f,h);return{abstract:c,concrete:f}}static _getMemberStatistic(s,c,f){if(F.isClass(f)){let h=f.declarations;if(h===void 0)return;for(let y of h)if(i.isClassDeclaration(y))for(let m of y.members)if(i.isMethodDeclaration(m)||i.isGetAccessorDeclaration(m)||i.isSetAccessorDeclaration(m)||i.isPropertyDeclaration(m)){let g=m.name.getText();F.includesAbstract(m.modifiers)&&!c.has(g)?s.add(g):c.add(g)}else i.isIndexSignatureDeclaration(m)&&(F.includesAbstract(m.modifiers)&&!c.has("[]")?s.add("[]"):c.add("[]"))}else if((F.isInterface(f)||F.isTypeLiteral(f))&&f.members!==void 0)for(let h of f.members.values())c.has(h.name)||s.add(h.name)}static includesAbstract(s){return s===void 0?!1:s.some(c=>c.kind===i.SyntaxKind.AbstractKeyword)}}O.Symbols=F;let nn;(f=>{function w(h){return h.projectService}f.getProjectService=w;function s(h,y){let m=h;if(typeof m.getFileAndProject=="function")return m.getFileAndProject(y)}f.getFileAndProject=s;function c(h,y,m){let g=h;if(typeof g.getPositionInFile=="function")return g.getPositionInFile(y,m)}f.getPositionInFile=c})(nn=O.Sessions||={});function on(w){return w.moduleReference.kind===i.SyntaxKind.ExternalModuleReference&&w.moduleReference.expression.kind===i.SyntaxKind.StringLiteral}class Kn{key;traversed;complete;outdated;importedBy;outdatedImportedBy;constructor(s){this.key=s,this.complete=!1,this.outdated=!1,this.traversed=new Set,this.importedBy=new Map,this.outdatedImportedBy=void 0}isComplete(){return this.complete}markComplete(){this.complete=!0,this.outdated=!1,this.outdatedImportedBy=void 0}addTraversed(s){this.traversed.add(s.fileName)}isTraversed(s){return this.traversed.has(s.fileName)}hasTraversed(){return this.traversed.size>0}imports(s,c){let f=this.importedBy.get(c.fileName);f===void 0&&(f=new Set,this.importedBy.set(c.fileName,f)),f.add(s.fileName)}getImportedBy(s,c){let f=this.importedBy.get(s.fileName);return f===void 0&&c&&(f=this.outdatedImportedBy?.get(s.fileName)),f===void 0?st:f.values()}markAsOutdated(){this.outdated=!0,this.outdatedImportedBy=this.importedBy,this.importedBy=new Map}isOutdated(){return this.outdated}}O.ImportedByState=Kn;class rn{program;sourceFile;preferredSourceFiles;token;importedByState;constructor(s,c,f,h,y){this.program=s,this.sourceFile=c,this.preferredSourceFiles=f,this.token=y;let m=O.Programs.getKey(s);this.importedByState=m!==void 0?h.getImportedByState(m):void 0}getSourceFile(s){return this.program.getSourceFile(s)}[Symbol.iterator](){return this.entries()}*entries(){this.token.throwIfCancellationRequested();let s=this.program;if(this.importedByState!==void 0){for(let m of this.importedByState.getImportedBy(this.sourceFile,!0)){this.token.throwIfCancellationRequested();let g=this.getSourceFile(m);g!==void 0&&!this.skipSourceFile(s,g)&&(yield g)}if(this.importedByState.isComplete()&&!this.importedByState.isOutdated())return}function c(m){return m.kind===i.SyntaxKind.ModuleDeclaration&&m.name.kind===i.SyntaxKind.StringLiteral}function f(m,g){let C=m.getSymbolAtLocation(g);if(!(C===void 0||!F.isSourceFile(C)))return C.declarations[0]}let h=s.getTypeChecker(),y=h.getSymbolAtLocation(this.sourceFile);if(y!==void 0)for(let m of this.allSourceFiles()){if(this.token.throwIfCancellationRequested(),this.sourceFile===m){yield m;continue}if(!this.skipSourceFile(s,m))if(m.externalModuleIndicator&&m.imports!==void 0)for(let g=0;g<m.imports.length;g++){this.token.throwIfCancellationRequested();let C=h.getSymbolAtLocation(m.imports[g]);if(C===y){if(this.importedByState!==void 0){this.importedByState.imports(m,this.sourceFile);for(let T=g+1;T<m.imports.length;T++){let K=f(h,m.imports[g]);K!==void 0&&!this.skipSourceFile(s,K)&&this.importedByState?.imports(m,K)}}yield m;break}else if(C!==void 0&&F.isSourceFile(C)){let T=C.declarations[0];this.skipSourceFile(s,T)||this.importedByState?.imports(m,T)}}else{let g=m,C=g.kind===i.SyntaxKind.SourceFile?g.statements:g.body.statements,T=K=>{switch(K.kind){case i.SyntaxKind.ExportDeclaration:case i.SyntaxKind.ImportDeclaration:{let P=K;if(P.moduleSpecifier&&i.isStringLiteral(P.moduleSpecifier)&&h.getSymbolAtLocation(P.moduleSpecifier)===y)return!0;break}case i.SyntaxKind.ImportEqualsDeclaration:{let P=K;if(on(P)&&h.getSymbolAtLocation(P.moduleReference.expression)===y)return!0;break}}return!1};e:for(let K of C)if(this.token.throwIfCancellationRequested(),T(K)){this.importedByState?.imports(m,this.sourceFile),yield m;break e}else if(c(K)){let P=K.body&&K.body.statements;if(P!==void 0){for(let _ of P)if(T(_)){this.importedByState?.imports(m,this.sourceFile),yield m;break e}}}}}}skipSourceFile(s,c){return s.isSourceFileDefaultLibrary(c)||s.isSourceFileFromExternalLibrary(c)||c.isDeclarationFile}*allSourceFiles(){if(this.importedByState===void 0)this.preferredSourceFiles!==void 0&&(yield*this.preferredSourceFiles),yield*this.program.getSourceFiles();else{if(this.preferredSourceFiles!==void 0){for(let s of this.preferredSourceFiles)this.importedByState.isTraversed(s)||(this.importedByState.addTraversed(s),yield s);for(let s of this.program.getSourceFiles())this.importedByState.isTraversed(s)||(this.importedByState.addTraversed(s),yield s)}this.importedByState.markComplete()}}}O.ReferencedByVisitor=rn;let sn;(f=>{let w=new Map([[i.SyntaxKind.Unknown,0],[i.SyntaxKind.EndOfFileToken,1],[i.SyntaxKind.SingleLineCommentTrivia,2],[i.SyntaxKind.MultiLineCommentTrivia,3],[i.SyntaxKind.NewLineTrivia,4],[i.SyntaxKind.WhitespaceTrivia,5],[i.SyntaxKind.ShebangTrivia,6],[i.SyntaxKind.ConflictMarkerTrivia,7],[i.SyntaxKind.NonTextFileMarkerTrivia,8],[i.SyntaxKind.NumericLiteral,9],[i.SyntaxKind.BigIntLiteral,10],[i.SyntaxKind.StringLiteral,11],[i.SyntaxKind.JsxText,12],[i.SyntaxKind.JsxTextAllWhiteSpaces,13],[i.SyntaxKind.RegularExpressionLiteral,14],[i.SyntaxKind.NoSubstitutionTemplateLiteral,15],[i.SyntaxKind.TemplateHead,16],[i.SyntaxKind.TemplateMiddle,17],[i.SyntaxKind.TemplateTail,18],[i.SyntaxKind.OpenBraceToken,19],[i.SyntaxKind.CloseBraceToken,20],[i.SyntaxKind.OpenParenToken,21],[i.SyntaxKind.CloseParenToken,22],[i.SyntaxKind.OpenBracketToken,23],[i.SyntaxKind.CloseBracketToken,24],[i.SyntaxKind.DotToken,25],[i.SyntaxKind.DotDotDotToken,26],[i.SyntaxKind.SemicolonToken,27],[i.SyntaxKind.CommaToken,28],[i.SyntaxKind.QuestionDotToken,29],[i.SyntaxKind.LessThanToken,30],[i.SyntaxKind.LessThanSlashToken,31],[i.SyntaxKind.GreaterThanToken,32],[i.SyntaxKind.LessThanEqualsToken,33],[i.SyntaxKind.GreaterThanEqualsToken,34],[i.SyntaxKind.EqualsEqualsToken,35],[i.SyntaxKind.ExclamationEqualsToken,36],[i.SyntaxKind.EqualsEqualsEqualsToken,37],[i.SyntaxKind.ExclamationEqualsEqualsToken,38],[i.SyntaxKind.EqualsGreaterThanToken,39],[i.SyntaxKind.PlusToken,40],[i.SyntaxKind.MinusToken,41],[i.SyntaxKind.AsteriskToken,42],[i.SyntaxKind.AsteriskAsteriskToken,43],[i.SyntaxKind.SlashToken,44],[i.SyntaxKind.PercentToken,45],[i.SyntaxKind.PlusPlusToken,46],[i.SyntaxKind.MinusMinusToken,47],[i.SyntaxKind.LessThanLessThanToken,48],[i.SyntaxKind.GreaterThanGreaterThanToken,49],[i.SyntaxKind.GreaterThanGreaterThanGreaterThanToken,50],[i.SyntaxKind.AmpersandToken,51],[i.SyntaxKind.BarToken,52],[i.SyntaxKind.CaretToken,53],[i.SyntaxKind.ExclamationToken,54],[i.SyntaxKind.TildeToken,55],[i.SyntaxKind.AmpersandAmpersandToken,56],[i.SyntaxKind.BarBarToken,57],[i.SyntaxKind.QuestionToken,58],[i.SyntaxKind.ColonToken,59],[i.SyntaxKind.AtToken,60],[i.SyntaxKind.QuestionQuestionToken,61],[i.SyntaxKind.BacktickToken,62],[i.SyntaxKind.HashToken,63],[i.SyntaxKind.EqualsToken,64],[i.SyntaxKind.PlusEqualsToken,65],[i.SyntaxKind.MinusEqualsToken,66],[i.SyntaxKind.AsteriskEqualsToken,67],[i.SyntaxKind.AsteriskAsteriskEqualsToken,68],[i.SyntaxKind.SlashEqualsToken,69],[i.SyntaxKind.PercentEqualsToken,70],[i.SyntaxKind.LessThanLessThanEqualsToken,71],[i.SyntaxKind.GreaterThanGreaterThanEqualsToken,72],[i.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken,73],[i.SyntaxKind.AmpersandEqualsToken,74],[i.SyntaxKind.BarEqualsToken,75],[i.SyntaxKind.BarBarEqualsToken,76],[i.SyntaxKind.AmpersandAmpersandEqualsToken,77],[i.SyntaxKind.QuestionQuestionEqualsToken,78],[i.SyntaxKind.CaretEqualsToken,79],[i.SyntaxKind.Identifier,80],[i.SyntaxKind.PrivateIdentifier,81],[i.SyntaxKind.BreakKeyword,83],[i.SyntaxKind.CaseKeyword,84],[i.SyntaxKind.CatchKeyword,85],[i.SyntaxKind.ClassKeyword,86],[i.SyntaxKind.ConstKeyword,87],[i.SyntaxKind.ContinueKeyword,88],[i.SyntaxKind.DebuggerKeyword,89],[i.SyntaxKind.DefaultKeyword,90],[i.SyntaxKind.DeleteKeyword,91],[i.SyntaxKind.DoKeyword,92],[i.SyntaxKind.ElseKeyword,93],[i.SyntaxKind.EnumKeyword,94],[i.SyntaxKind.ExportKeyword,95],[i.SyntaxKind.ExtendsKeyword,96],[i.SyntaxKind.FalseKeyword,97],[i.SyntaxKind.FinallyKeyword,98],[i.SyntaxKind.ForKeyword,99],[i.SyntaxKind.FunctionKeyword,100],[i.SyntaxKind.IfKeyword,101],[i.SyntaxKind.ImportKeyword,102],[i.SyntaxKind.InKeyword,103],[i.SyntaxKind.InstanceOfKeyword,104],[i.SyntaxKind.NewKeyword,105],[i.SyntaxKind.NullKeyword,106],[i.SyntaxKind.ReturnKeyword,107],[i.SyntaxKind.SuperKeyword,108],[i.SyntaxKind.SwitchKeyword,109],[i.SyntaxKind.ThisKeyword,110],[i.SyntaxKind.ThrowKeyword,111],[i.SyntaxKind.TrueKeyword,112],[i.SyntaxKind.TryKeyword,113],[i.SyntaxKind.TypeOfKeyword,114],[i.SyntaxKind.VarKeyword,115],[i.SyntaxKind.VoidKeyword,116],[i.SyntaxKind.WhileKeyword,117],[i.SyntaxKind.WithKeyword,118],[i.SyntaxKind.ImplementsKeyword,119],[i.SyntaxKind.InterfaceKeyword,120],[i.SyntaxKind.LetKeyword,121],[i.SyntaxKind.PackageKeyword,122],[i.SyntaxKind.PrivateKeyword,123],[i.SyntaxKind.ProtectedKeyword,124],[i.SyntaxKind.PublicKeyword,125],[i.SyntaxKind.StaticKeyword,126],[i.SyntaxKind.YieldKeyword,127],[i.SyntaxKind.AbstractKeyword,128],[i.SyntaxKind.AccessorKeyword,129],[i.SyntaxKind.AsKeyword,130],[i.SyntaxKind.AssertsKeyword,131],[i.SyntaxKind.AssertKeyword,132],[i.SyntaxKind.AnyKeyword,133],[i.SyntaxKind.AsyncKeyword,134],[i.SyntaxKind.AwaitKeyword,135],[i.SyntaxKind.BooleanKeyword,136],[i.SyntaxKind.ConstructorKeyword,137],[i.SyntaxKind.DeclareKeyword,138],[i.SyntaxKind.GetKeyword,139],[i.SyntaxKind.InferKeyword,140],[i.SyntaxKind.IntrinsicKeyword,141],[i.SyntaxKind.IsKeyword,142],[i.SyntaxKind.KeyOfKeyword,143],[i.SyntaxKind.ModuleKeyword,144],[i.SyntaxKind.NamespaceKeyword,145],[i.SyntaxKind.NeverKeyword,146],[i.SyntaxKind.OutKeyword,147],[i.SyntaxKind.ReadonlyKeyword,148],[i.SyntaxKind.RequireKeyword,149],[i.SyntaxKind.NumberKeyword,150],[i.SyntaxKind.ObjectKeyword,151],[i.SyntaxKind.SatisfiesKeyword,152],[i.SyntaxKind.SetKeyword,153],[i.SyntaxKind.StringKeyword,154],[i.SyntaxKind.SymbolKeyword,155],[i.SyntaxKind.TypeKeyword,156],[i.SyntaxKind.UndefinedKeyword,157],[i.SyntaxKind.UniqueKeyword,158],[i.SyntaxKind.UnknownKeyword,159],[i.SyntaxKind.UsingKeyword,160],[i.SyntaxKind.FromKeyword,161],[i.SyntaxKind.GlobalKeyword,162],[i.SyntaxKind.BigIntKeyword,163],[i.SyntaxKind.OverrideKeyword,164],[i.SyntaxKind.OfKeyword,165],[i.SyntaxKind.QualifiedName,166],[i.SyntaxKind.ComputedPropertyName,167],[i.SyntaxKind.TypeParameter,168],[i.SyntaxKind.Parameter,169],[i.SyntaxKind.Decorator,170],[i.SyntaxKind.PropertySignature,171],[i.SyntaxKind.PropertyDeclaration,172],[i.SyntaxKind.MethodSignature,173],[i.SyntaxKind.MethodDeclaration,174],[i.SyntaxKind.ClassStaticBlockDeclaration,175],[i.SyntaxKind.Constructor,176],[i.SyntaxKind.GetAccessor,177],[i.SyntaxKind.SetAccessor,178],[i.SyntaxKind.CallSignature,179],[i.SyntaxKind.ConstructSignature,180],[i.SyntaxKind.IndexSignature,181],[i.SyntaxKind.TypePredicate,182],[i.SyntaxKind.TypeReference,183],[i.SyntaxKind.FunctionType,184],[i.SyntaxKind.ConstructorType,185],[i.SyntaxKind.TypeQuery,186],[i.SyntaxKind.TypeLiteral,187],[i.SyntaxKind.ArrayType,188],[i.SyntaxKind.TupleType,189],[i.SyntaxKind.OptionalType,190],[i.SyntaxKind.RestType,191],[i.SyntaxKind.UnionType,192],[i.SyntaxKind.IntersectionType,193],[i.SyntaxKind.ConditionalType,194],[i.SyntaxKind.InferType,195],[i.SyntaxKind.ParenthesizedType,196],[i.SyntaxKind.ThisType,197],[i.SyntaxKind.TypeOperator,198],[i.SyntaxKind.IndexedAccessType,199],[i.SyntaxKind.MappedType,200],[i.SyntaxKind.LiteralType,201],[i.SyntaxKind.NamedTupleMember,202],[i.SyntaxKind.TemplateLiteralType,203],[i.SyntaxKind.TemplateLiteralTypeSpan,204],[i.SyntaxKind.ImportType,205],[i.SyntaxKind.ObjectBindingPattern,206],[i.SyntaxKind.ArrayBindingPattern,207],[i.SyntaxKind.BindingElement,208],[i.SyntaxKind.ArrayLiteralExpression,209],[i.SyntaxKind.ObjectLiteralExpression,210],[i.SyntaxKind.PropertyAccessExpression,211],[i.SyntaxKind.ElementAccessExpression,212],[i.SyntaxKind.CallExpression,213],[i.SyntaxKind.NewExpression,214],[i.SyntaxKind.TaggedTemplateExpression,215],[i.SyntaxKind.TypeAssertionExpression,216],[i.SyntaxKind.ParenthesizedExpression,217],[i.SyntaxKind.FunctionExpression,218],[i.SyntaxKind.ArrowFunction,219],[i.SyntaxKind.DeleteExpression,220],[i.SyntaxKind.TypeOfExpression,221],[i.SyntaxKind.VoidExpression,222],[i.SyntaxKind.AwaitExpression,223],[i.SyntaxKind.PrefixUnaryExpression,224],[i.SyntaxKind.PostfixUnaryExpression,225],[i.SyntaxKind.BinaryExpression,226],[i.SyntaxKind.ConditionalExpression,227],[i.SyntaxKind.TemplateExpression,228],[i.SyntaxKind.YieldExpression,229],[i.SyntaxKind.SpreadElement,230],[i.SyntaxKind.ClassExpression,231],[i.SyntaxKind.OmittedExpression,232],[i.SyntaxKind.ExpressionWithTypeArguments,233],[i.SyntaxKind.AsExpression,234],[i.SyntaxKind.NonNullExpression,235],[i.SyntaxKind.MetaProperty,236],[i.SyntaxKind.SyntheticExpression,237],[i.SyntaxKind.SatisfiesExpression,238],[i.SyntaxKind.TemplateSpan,239],[i.SyntaxKind.SemicolonClassElement,240],[i.SyntaxKind.Block,241],[i.SyntaxKind.EmptyStatement,242],[i.SyntaxKind.VariableStatement,243],[i.SyntaxKind.ExpressionStatement,244],[i.SyntaxKind.IfStatement,245],[i.SyntaxKind.DoStatement,246],[i.SyntaxKind.WhileStatement,247],[i.SyntaxKind.ForStatement,248],[i.SyntaxKind.ForInStatement,249],[i.SyntaxKind.ForOfStatement,250],[i.SyntaxKind.ContinueStatement,251],[i.SyntaxKind.BreakStatement,252],[i.SyntaxKind.ReturnStatement,253],[i.SyntaxKind.WithStatement,254],[i.SyntaxKind.SwitchStatement,255],[i.SyntaxKind.LabeledStatement,256],[i.SyntaxKind.ThrowStatement,257],[i.SyntaxKind.TryStatement,258],[i.SyntaxKind.DebuggerStatement,259],[i.SyntaxKind.VariableDeclaration,260],[i.SyntaxKind.VariableDeclarationList,261],[i.SyntaxKind.FunctionDeclaration,262],[i.SyntaxKind.ClassDeclaration,263],[i.SyntaxKind.InterfaceDeclaration,264],[i.SyntaxKind.TypeAliasDeclaration,265],[i.SyntaxKind.EnumDeclaration,266],[i.SyntaxKind.ModuleDeclaration,267],[i.SyntaxKind.ModuleBlock,268],[i.SyntaxKind.CaseBlock,269],[i.SyntaxKind.NamespaceExportDeclaration,270],[i.SyntaxKind.ImportEqualsDeclaration,271],[i.SyntaxKind.ImportDeclaration,272],[i.SyntaxKind.ImportClause,273],[i.SyntaxKind.NamespaceImport,274],[i.SyntaxKind.NamedImports,275],[i.SyntaxKind.ImportSpecifier,276],[i.SyntaxKind.ExportAssignment,277],[i.SyntaxKind.ExportDeclaration,278],[i.SyntaxKind.NamedExports,279],[i.SyntaxKind.NamespaceExport,280],[i.SyntaxKind.ExportSpecifier,281],[i.SyntaxKind.MissingDeclaration,282],[i.SyntaxKind.ExternalModuleReference,283],[i.SyntaxKind.JsxElement,284],[i.SyntaxKind.JsxSelfClosingElement,285],[i.SyntaxKind.JsxOpeningElement,286],[i.SyntaxKind.JsxClosingElement,287],[i.SyntaxKind.JsxFragment,288],[i.SyntaxKind.JsxOpeningFragment,289],[i.SyntaxKind.JsxClosingFragment,290],[i.SyntaxKind.JsxAttribute,291],[i.SyntaxKind.JsxAttributes,292],[i.SyntaxKind.JsxSpreadAttribute,293],[i.SyntaxKind.JsxExpression,294],[i.SyntaxKind.JsxNamespacedName,295],[i.SyntaxKind.CaseClause,296],[i.SyntaxKind.DefaultClause,297],[i.SyntaxKind.HeritageClause,298],[i.SyntaxKind.CatchClause,299],[i.SyntaxKind.ImportAttributes,300],[i.SyntaxKind.ImportAttribute,301],[i.SyntaxKind.PropertyAssignment,303],[i.SyntaxKind.ShorthandPropertyAssignment,304],[i.SyntaxKind.SpreadAssignment,305],[i.SyntaxKind.EnumMember,306],[i.SyntaxKind.SourceFile,307],[i.SyntaxKind.Bundle,308],[i.SyntaxKind.JSDocTypeExpression,309],[i.SyntaxKind.JSDocNameReference,310],[i.SyntaxKind.JSDocMemberName,311],[i.SyntaxKind.JSDocAllType,312],[i.SyntaxKind.JSDocUnknownType,313],[i.SyntaxKind.JSDocNullableType,314],[i.SyntaxKind.JSDocNonNullableType,315],[i.SyntaxKind.JSDocOptionalType,316],[i.SyntaxKind.JSDocFunctionType,317],[i.SyntaxKind.JSDocVariadicType,318],[i.SyntaxKind.JSDocNamepathType,319],[i.SyntaxKind.JSDoc,320],[i.SyntaxKind.JSDocText,321],[i.SyntaxKind.JSDocTypeLiteral,322],[i.SyntaxKind.JSDocSignature,323],[i.SyntaxKind.JSDocLink,324],[i.SyntaxKind.JSDocLinkCode,325],[i.SyntaxKind.JSDocLinkPlain,326],[i.SyntaxKind.JSDocTag,327],[i.SyntaxKind.JSDocAugmentsTag,328],[i.SyntaxKind.JSDocImplementsTag,329],[i.SyntaxKind.JSDocAuthorTag,330],[i.SyntaxKind.JSDocDeprecatedTag,331],[i.SyntaxKind.JSDocClassTag,332],[i.SyntaxKind.JSDocPublicTag,333],[i.SyntaxKind.JSDocPrivateTag,334],[i.SyntaxKind.JSDocProtectedTag,335],[i.SyntaxKind.JSDocReadonlyTag,336],[i.SyntaxKind.JSDocOverrideTag,337],[i.SyntaxKind.JSDocCallbackTag,338],[i.SyntaxKind.JSDocOverloadTag,339],[i.SyntaxKind.JSDocEnumTag,340],[i.SyntaxKind.JSDocParameterTag,341],[i.SyntaxKind.JSDocReturnTag,342],[i.SyntaxKind.JSDocThisTag,343],[i.SyntaxKind.JSDocTypeTag,344],[i.SyntaxKind.JSDocTemplateTag,345],[i.SyntaxKind.JSDocTypedefTag,346],[i.SyntaxKind.JSDocSeeTag,347],[i.SyntaxKind.JSDocPropertyTag,348],[i.SyntaxKind.JSDocThrowsTag,349],[i.SyntaxKind.JSDocSatisfiesTag,350],[i.SyntaxKind.JSDocImportTag,351],[i.SyntaxKind.SyntaxList,352],[i.SyntaxKind.NotEmittedStatement,353],[i.SyntaxKind.PartiallyEmittedExpression,354],[i.SyntaxKind.CommaListExpression,355],[i.SyntaxKind.SyntheticReferenceExpression,356],[i.SyntaxKind.NotEmittedTypeElement,357]]),s=9999;function c(h){let y=[];for(;h!==void 0;)y.push(w.get(h.kind)??s),h=h.parent;return y}f.getPath=c})(sn=O.StableSyntaxKinds||={})})(qt||={});_t.exports=qt});var at,dt,De,Ot=J(()=>{"use strict";at=class{[Symbol.toStringTag]="LinkedMap";_map;_head;_tail;_size;_state;constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let o=this._map.get(e);if(o)o.value=t,n!==0&&this.touch(o,n);else{switch(o={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(o);break;case 1:this.addItemFirst(o);break;case 2:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,o=this._head;for(;o;){if(t?e.bind(t)(o.value,o.key,this):e(o.value,o.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){let e=this,t=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.key,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return o}values(){let e=this,t=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:n.value,done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return o}entries(){let e=this,t=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let r={value:[n.key,n.value],done:!1};return n=n.next,r}else return{value:void 0,done:!0}}};return o}[Symbol.iterator](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.previous,n--;this._tail=t,this._size=n,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,o=e.previous;e===this._tail?(o.next=void 0,this._tail=o):(n.previous=o,o.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,o=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=o,o.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}},dt=class extends at{_limit;_ratio;constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},De=class extends dt{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}});var E,z,A,ge,Pe,G,lt,ct,Re,Ne,ut,ce,j,Ae,$,xe,Ee,ne=J(()=>{"use strict";H();W();E=ee(te());Ot();z=N(),A=class extends Error{static SourceFileNotFound=1;static NodeNotFound=2;static NodeKindMismatch=3;static SymbolNotFound=4;static NoDeclaration=5;static NoProgram=6;static NoSourceFile=7;code;constructor(e,t){super(e),this.code=t}},ge=class{getSymbolInfo(e){let t=e.declarations;if(t===void 0||t.length===0)return{skip:!0};let n,o=0,r=this.getProgram();for(let d of t){let a=d.getSourceFile();n===void 0&&(n=a),(r.isSourceFileDefaultLibrary(a)||r.isSourceFileFromExternalLibrary(a))&&o++}return o>0?{skip:!0}:{skip:!1,primary:n}}skipDeclaration(e,t=e.getSourceFile()){let n=this.getProgram();return n.isSourceFileDefaultLibrary(t)||n.isSourceFileFromExternalLibrary(t)||t.isDeclarationFile}},Pe=class{symbols;seenSymbols;neighborFiles;knownContextItems;constructor(e,t,n){this.symbols=new Map,this.neighborFiles=t,this.knownContextItems=n;let o=[];for(let r of n.values())r.emitMode==="clientBased"&&o.push(r.key);this.seenSymbols=new ut(e,o)}getSymbols(e){let t=this.symbols.get(e);return t===void 0&&(t=new E.Symbols(e),this.symbols.set(e,t)),t}getSeenSymbols(){return this.seenSymbols}getPreferredNeighborFiles(e){let t=[];for(let n of this.neighborFiles){let o=e.getSourceFile(n);o!==void 0&&t.push(o)}return t}isCachedOnClient(e){return this.knownContextItems.has(e)}getCachedContextItem(e){return this.knownContextItems.get(e)}},G=class extends ge{program;symbols;constructor(e,t=new E.Symbols(e)){if(super(),e!==t.getProgram())throw new Error("Program and symbols program must match");this.program=e,this.symbols=t}getSymbols(){return this.symbols}getProgram(){return this.program}getHeritageSymbol(e){let t=this.symbols.getSymbolAtLocation(e);if(t===void 0)return;E.Symbols.isAlias(t)&&(t=this.symbols.getAliasedSymbol(t));let n=0;for(;E.Symbols.isTypeAlias(t)&&n<10;){let o=t.declarations;if(o!==void 0){let r=t;for(let d of o)if(z.isTypeAliasDeclaration(d)){let a=d.type;z.isTypeReferenceNode(a)&&(t=this.symbols.getLeafSymbolAtLocation(a.typeName))}if(r===t)break}n++}return t}static getNodeInProgram(e,t){function n(u,l){if(u===void 0||l===void 0)return u===l;for(;u!==void 0&&l!==void 0;){if(u.kind!==l.kind||u.pos!==l.pos||u.end!==l.end)return!1;u=u.parent,l=l.parent}return u===void 0&&l===void 0}let o=t.getSourceFile().fileName,r=e.getSourceFile(o);if(r===void 0)throw new A(`No source file found for ${o}`,A.SourceFileNotFound);let d=E.default.getTokenAtPosition(r,t.pos),a=d;if(a===void 0)throw new A(`No node found for ${o}:${t.pos}`,A.NodeNotFound);for(;a!==void 0;){if(t.pos===a.pos&&t.end===a.end&&t.kind===a.kind&&n(t.parent,a.parent))return a;a=a.parent}throw new A(`Found node ${d.kind} for node ${t.kind} in file ${o}:${t.pos}`,A.NodeKindMismatch)}},lt=class{info(){}msg(){}startGroup(){}endGroup(){}},ct=class{host;codeCache;importedByState;supportsCaching;constructor(e,t){this.host=e,this.codeCache=new De(100),this.importedByState=new Map,this.supportsCaching=t}getImportedByState(e){let t=this.importedByState.get(e);return t===void 0&&(t=new E.ImportedByState(e),this.importedByState.set(e,t)),t}run(e,t,n){let o=this.getPossiblePrograms(e,t);for(let r of o){let a=e.with(r).run(t,n);if(a!==void 0)return[r,a]}return[void 0,void 0]}getPossiblePrograms(e,t){let n=[];for(let o of this.getLanguageServices()){let r=o.getProgram();if(r===void 0)continue;let d=e.score(r,t);d>0&&n.push([d,r])}return n.sort((o,r)=>r[0]-o[0]).map(o=>o[1])}getCachedCode(e,t){if(this.supportsCaching){if(typeof e=="string")return this.codeCache.get(e);{let n=E.Symbols.createVersionedKey(t,this,this.host);return n===void 0?void 0:this.codeCache.get(n)}}}cacheCode(e,t){if(this.supportsCaching)if(typeof e=="string")this.codeCache.set(e,t);else{let n=E.Symbols.createVersionedKey(e,this,this.host);n!==void 0&&this.codeCache.set(n,t)}}addComputationStateItems(e,t){let n=t.getImportsByCacheRange();if(n===void 0){for(let o of this.importedByState.values())o.markAsOutdated();return}e.addComputationState("importedByState",{kind:"range",range:n})}applyComputationStates(e){let t=!1;for(let n of e)n.kind==="computationState"&&n.key==="importedByState"&&(t=!0);if(!t)for(let n of this.importedByState.values())n.markAsOutdated()}enableBlueprintSearch(){return!1}},Re=class extends ct{session;logger;constructor(e,t){super(t,!0),this.session=e;let n=E.Sessions.getProjectService(this.session);this.logger=n?.logger??new lt}logError(e,t){this.session.logError(e,t)}getFileAndProject(e){return E.Sessions.getFileAndProject(this.session,e)}getPositionInFile(e,t){return E.Sessions.getPositionInFile(this.session,e,t)}*getLanguageServices(e){let t=E.Sessions.getProjectService(this.session);if(t!==void 0)if(e===void 0){for(let n of t.configuredProjects.values())yield n.getLanguageService();for(let n of t.inferredProjects)yield n.getLanguageService();for(let n of t.externalProjects)yield n.getLanguageService()}else{let n=z.server.toNormalizedPath(e.fileName),o=t.getScriptInfoForNormalizedPath(n);yield*o?o.containingProjects.map(r=>r.getLanguageService()):[]}}getScriptVersion(e){let t=z.server.toNormalizedPath(e.fileName),n=E.Sessions.getProjectService(this.session);return n===void 0?void 0:n.getScriptInfoForNormalizedPath(t)?.getLatestVersion()}},Ne=class{tokenBudget;_metaItems=[];_items;_cachedItems;constructor(e){this.tokenBudget=e,this._metaItems=[],this._items=[],this._cachedItems=new Set}get items(){return this._metaItems.concat(this._items)}addMetaData(e,t){this._metaItems.push(tt.create(e,t))}addErrorData(e){this._metaItems.push(nt.create(e.code,e.message))}addTimings(e,t){this._metaItems.push(it.create(e,t))}addCachedContextItem(e,t=!1){if(this._cachedItems.has(e.key))return!0;let n=e.sizeInChars;return t&&n!==void 0&&!this.tokenBudget.hasRoom(n)?!1:(this._items.push(ot.create(e.key,e.emitMode)),this._cachedItems.add(e.key),n!==void 0&&this.tokenBudget.spent(n),!0)}addComputationState(e,t){this._items.push(rt.create(e,t))}addTrait(e,t,n,o,r){let d=X.create(e,t,n,o,r);this._items.push(d),this.tokenBudget.spent(X.sizeInChars(d))}addSnippet(e,t,n,o,r,d=!1){if(e.isEmpty())return!0;let a=e.snippet(t,n,o,r),u=be.sizeInChars(a);return d&&!this.tokenBudget.hasRoom(u)?!1:(this.tokenBudget.spent(u),this._items.push(a),!0)}},ut=class{session;symbols=new Set;keys=new Set;constructor(e,t){this.session=e,this.symbols=new Set,this.keys=t?new Set(t):new Set}add(e){this.symbols.add(e);let t=E.Symbols.createKey(e,this.session.host);t!==void 0&&this.keys.add(t)}has(e){if(this.symbols.has(e))return!0;let t=E.Symbols.createKey(e,this.session.host);return t===void 0?!1:this.keys.has(t)?(this.symbols.add(e),!0):!1}manages(e){return this.has(e)?!0:(this.add(e),!1)}};(n=>{function p(o){let r=o.body;if(!(r===void 0||!z.isBlock(r)))return e(r,o.getSourceFile())}n.fromDeclaration=p;function e(o,r){let d,a;t(o)?(d=o.pos,a=o.end):(d=o.getStart(r),a=o.getEnd(),r===void 0&&(r=o.getSourceFile()));let u=z.getLineAndCharacterOfPosition(r,d),l=z.getLineAndCharacterOfPosition(r,a);return{kind:"range",range:{start:u,end:l}}}n.create=e;function t(o){return Array.isArray(o)}})(ce||={});j=class{session;languageService;program;context;symbols;priority;cost;constructor(e,t,n,o,r){this.session=e,this.languageService=t,this.program=t.getProgram(),this.context=n,this.symbols=n.getSymbols(this.getProgram()),this.priority=o,this.cost=r}getProgram(){if(this.program===void 0)throw new A("No program available",A.NoProgram);return this.program}getSeenSymbols(){return this.context.getSeenSymbols()}createCacheScope(e,t){return ce.create(e,t)}createCacheInfo(e,t,n,o){if(e===void 0)return;let r=E.Symbols.createKey(e,this.session.host);if(r===void 0)return;let d=ce.create(n,o);return{key:r,emitMode:t,scope:d}}createCacheInfoFromScope(e,t,n){if(e===void 0)return;let o=E.Symbols.createKey(e,this.session.host);if(o!==void 0)return{key:o,emitMode:t,scope:Object.assign({},n)}}handleSymbolIfCachedOrSeen(e,t,n,o){if(o===void 0)return[!1,void 0];let r=o!==void 0?this.createCacheInfoFromScope(t,n,o):void 0,d=r!==void 0?this.context.getCachedContextItem(r.key):void 0,a=this.getSeenSymbols();return d===void 0?a.has(t)?[!0,void 0]:[!1,r]:(e.addCachedContextItem(d),a.add(t),[!0,r])}isNodeArray(e){return Array.isArray(e)}skipSourceFile(e){let t=this.getProgram();return t.isSourceFileDefaultLibrary(e)||t.isSourceFileFromExternalLibrary(e)}getSymbolsToEmitForTypeNode(e){let t=[];return this.doGetSymbolsToEmitForTypeNode(t,e),t}doGetSymbolsToEmitForTypeNode(e,t){if(z.isTypeReferenceNode(t)){let n=this.symbols.getLeafSymbolAtLocation(t.typeName);n!==void 0&&e.push({symbol:n,name:t.typeName.getText()})}else if(z.isUnionTypeNode(t)||z.isIntersectionTypeNode(t))for(let n of t.types)this.doGetSymbolsToEmitForTypeNode(e,n)}getSymbolsToEmitForType(e){let t=[];return this.doGetSymbolsToEmitForType(t,e),t}doGetSymbolsToEmitForType(e,t){let n=t.getSymbol();if(n!==void 0)e.push({symbol:n,name:n.getName()});else if(E.Types.isIntersection(t)||E.Types.isUnion(t))for(let o of t.types)this.doGetSymbolsToEmitForType(e,o)}},Ae=class{primary;secondary;tertiary;constructor(){this.primary=[],this.secondary=[],this.tertiary=[]}addPrimary(e){this.primary.push(e)}addSecondary(e){this.secondary.push(e)}addTertiary(e){this.tertiary.push(e)}getPrimaryRunnables(){return this.primary.sort((e,t)=>{let n=e.cost-t.cost;return n!==0?n:t.priority-e.priority})}getSecondaryRunnables(){return this.secondary.sort((e,t)=>{let n=e.cost-t.cost;return n!==0?n:t.priority-e.priority})}getTertiaryRunnables(){return this.tertiary.sort((e,t)=>{let n=e.cost-t.cost;return n!==0?n:t.priority-e.priority})}},$=class{contextKind;symbolsToQuery;constructor(e,t){this.contextKind=e,this.symbolsToQuery=t}isCallableProvider;_getImportsByCacheRange(e){let t=e.getSourceFile(),n=e.getStart(t),o=z.getLineAndCharacterOfPosition(t,n),r=z.getLineAndCharacterOfPosition(t,e.getEnd());return{start:o,end:r}}},xe=class extends Error{constructor(){super("Budget exhausted")}},Ee=class{charBudget;lowWaterMark;itemRejected;constructor(e,t=64){this.charBudget=e*4,this.lowWaterMark=t*4,this.itemRejected=!1}spent(e){this.charBudget-=e}hasRoom(e){let t=this.charBudget-this.lowWaterMark>=e;return t||(this.itemRejected=!0),t}isExhausted(){return this.charBudget<=0}wasItemRejected(){return this.itemRejected}throwIfExhausted(){if(this.charBudget<=0)throw new xe}spentAndThrowIfExhausted(e){this.spent(e),this.throwIfExhausted()}}});var I,L,ie,ue,Ce,Le,Be,pt,qe,mt,ft,B,Te=J(()=>{"use strict";H();ne();W();I=ee(te()),L=N();(o=>{function p(r,d){d??=r.getSourceFile();let a=r.getStart(d,!0),u=d.getLineAndCharacterOfPosition(a),b=d.text.substring(a,r.getEnd()).split(/\r?\n/g);if(u.character>0){let S=d.getPositionOfLineAndCharacter(u.line,0),x=d.text.substring(S,a);t(b,x)}return n(b),b}o.getLines=p;function e(r){let d=r.getFullText(),a=L.getLeadingCommentRanges(d,0);if(a!==void 0&&a.length>0){let u=a.at(-1).pos,l=a.at(-1).end,S=d.substring(u,l).trim().split(/\r?\n/);if(n(S),S.length>1){let v=S[1].match(/^\s+/);v!==null&&t(S,v[0])}return S}}o.getDocumentation=e;function t(r,d,a=1){let u=!0;for(let l=a;l<r.length;l++)if(!r[l].startsWith(d)){u=!1;break}if(u)for(let l=a;l<r.length;l++)r[l]=r[l].substring(d.length)}function n(r){for(;r.length>0&&r[0].trim()==="";)r.shift();for(;r.length>0&&r.at(-1).trim()==="";)r.pop()}})(ie||={});ue=class{session;indent;lines;source;additionalSources;constructor(e,t,n=0){this.session=e,this.indent=n,this.source=t.fileName,this.lines=[],this.additionalSources=new Set}makeKey(e){if(Array.isArray(e)){if(e.length===0)return;let t=[];for(let n of e){let o=I.Symbols.createVersionedKey(n,this.session,this.session.host);if(o!==void 0)t.push(o);else{t=void 0;break}}return t===void 0?void 0:t.join(";")}else return I.Symbols.createVersionedKey(e,this.session,this.session.host)}getAdditionalSources(){return this.additionalSources.delete(this.source),this.additionalSources}increaseIndent(){this.indent++}decreaseIndent(){this.indent--}addConstructorDeclaration(e){let t=ie.getDocumentation(e);t!==void 0&&this.lines.push(...t);let n=[];n.push("	".repeat(this.indent)),e.modifiers!==void 0&&(n.push(e.modifiers.map(o=>o.getText()).join(" ")),n.push(" ")),n.push("constructor"),n.push("("),n.push(this.getParameters(e.parameters)),n.push(");"),this.lines.push(n.join(""))}addPropertyDeclaration(e){this.lines.push(...ie.getLines(e))}addMethodDeclaration(e){let t=ie.getDocumentation(e);t!==void 0&&this.lines.push(...t);let n=[];n.push("	".repeat(this.indent)),e.modifiers!==void 0&&(n.push(e.modifiers.map(o=>o.getText()).join(" ")),n.push(" ")),n.push(e.name.getText()),e.typeParameters!==void 0&&(n.push("<"),n.push(e.typeParameters.map(o=>o.getText()).join(", ")),n.push(">")),n.push("("),e.parameters!==void 0&&n.push(e.parameters.map(o=>o.getText()).join(", ")),n.push(")"),e.type!==void 0&&(n.push(": "),n.push(e.type.getText())),n.push(";"),this.lines.push(n.join(""))}addCallSignatureDeclaration(e){let t=ie.getDocumentation(e);t!==void 0&&this.lines.push(...t);let n=[];n.push("	".repeat(this.indent)),e.typeParameters!==void 0&&(n.push("<"),n.push(e.typeParameters.map(o=>o.getText()).join(", ")),n.push(">")),n.push("("),e.parameters!==void 0&&n.push(e.parameters.map(o=>o.getText()).join(", ")),n.push(")"),e.type!==void 0&&(n.push(": "),n.push(e.type.getText())),n.push(";"),this.lines.push(n.join(""))}addGetAccessorDeclaration(e){this.addAccessorDeclaration(e,"get")}addSetAccessorDeclaration(e){this.addAccessorDeclaration(e,"set")}addAccessorDeclaration(e,t){let n=ie.getDocumentation(e);n!==void 0&&this.lines.push(...n);let o=[];o.push("	".repeat(this.indent)),e.modifiers!==void 0&&(o.push(e.modifiers.map(r=>r.getText()).join(" ")),o.push(" ")),o.push(`${t} `),o.push(e.name.getText()),e.type!==void 0&&(o.push(": "),o.push(e.type.getText())),o.push(";"),this.lines.push(o.join(""))}addFunctionDeclaration(e,t,n){t??=e.name?.getText()??"";let o=ie.getDocumentation(e);o!==void 0&&this.lines.push(...o);let r=[];r.push("	".repeat(this.indent)),r.push(this.getModifiers(e.modifiers,n)),r.push(" function "),r.push(t),r.push(this.getTypeParameters(e.typeParameters)),r.push("("),r.push(this.getParameters(e.parameters)),r.push(")"),r.push(this.getReturnTypes(e)),r.push(";"),this.lines.push(r.join(""))}getModifiers(e,t){if(e===void 0)return"";let n=[];t!==void 0&&n.push(t);for(let o of e)o.kind===L.SyntaxKind.AsyncKeyword||o.kind===L.SyntaxKind.DeclareKeyword||o.kind===L.SyntaxKind.ExportKeyword||n.push(o.getText());return n.join(" ")}getTypeParameters(e){if(e===void 0)return"";let t=[];return t.push("<"),t.push(e.map(n=>n.getText()).join(", ")),t.push(">"),t.join("")}getParameters(e){return e===void 0?"":e.map(t=>t.getText()).join(", ")}getReturnTypes(e){return e.type===void 0?"":`: ${e.type.getText()}`}},Ce=class extends ue{type;name;constructor(e,t,n,o){super(e,t),this.type=n,this.name=o}processMembers(e){for(let[t,n]of e)this.processMember(n)}processMember(e){let t=e.declarations;if(t!==void 0){if(I.Symbols.isProperty(e)){let n=t[0];(L.isPropertyDeclaration(n)||L.isPropertySignature(n))&&this.addPropertyDeclaration(n)}else if(I.Symbols.isMethod(e))for(let n of t)(L.isMethodDeclaration(n)||L.isMethodSignature(n))&&this.addMethodDeclaration(n);else if(I.Symbols.isSetAccessor(e)||I.Symbols.isGetAccessor(e))for(let n of t)L.isGetAccessorDeclaration(n)?this.addGetAccessorDeclaration(n):L.isSetAccessorDeclaration(n)&&this.addSetAccessorDeclaration(n);else if(I.Symbols.isSignature(e))for(let n of t)L.isCallSignatureDeclaration(n)&&this.addCallSignatureDeclaration(n);else if(I.Symbols.isConstructor(e))for(let n of t)L.isConstructorDeclaration(n)&&this.addConstructorDeclaration(n)}}getTypeParameters(){let e=this.type.declarations;if(e===void 0||e.length===0)return"";let t=e[0];return(L.isClassDeclaration(t)||L.isInterfaceDeclaration(t)||L.isTypeAliasDeclaration(t))&&t.typeParameters!==void 0?super.getTypeParameters(t.typeParameters):""}},Le=class extends Ce{superClasses;includePrivates;key;constructor(e,t,n,o,r,d,a){super(e,n,o,r),this.includePrivates=a,this.key=void 0,d?(this.superClasses=new Array(...t.getAllSuperClasses(o)),this.key=this.makeKey([o,...this.superClasses])):(this.key=this.makeKey(o),this.superClasses=void 0)}emit(){if(this.lines.push(`declare class ${this.name}${this.getTypeParameters()} {`),this.increaseIndent(),this.superClasses!==void 0)for(let e=this.superClasses.length-1;e>=0;e--){let t=this.superClasses[e];t.members!==void 0&&(I.Symbols.fillSources(this.additionalSources,t),this.processMembers(t.members))}this.type.members!==void 0&&(I.Symbols.fillSources(this.additionalSources,this.type),this.processMembers(this.type.members)),this.decreaseIndent(),this.lines.push("}")}processMember(e){!this.includePrivates&&I.Symbols.isPrivate(e)||super.processMember(e)}},Be=class extends Ce{superTypes;key;constructor(e,t,n,o,r){super(e,n,o,r),this.superTypes=new Array(...t.getAllSuperTypes(o)).filter(d=>I.Symbols.isInterface(d)),this.superTypes.length===0?this.key=this.makeKey(o):this.key=this.makeKey([o,...this.superTypes])}emit(){this.lines.push(`interface ${this.name}${this.getTypeParameters()} {`),this.increaseIndent();for(let e=this.superTypes.length-1;e>=0;e--){let t=this.superTypes[e];t.members!==void 0&&(I.Symbols.fillSources(this.additionalSources,t),this.processMembers(t.members))}this.type.members!==void 0&&(I.Symbols.fillSources(this.additionalSources,this.type),this.processMembers(this.type.members)),this.decreaseIndent(),this.lines.push("}")}},pt=class extends ue{type;name;key;constructor(e,t,n,o){super(e,t),this.type=n,this.name=o,this.key=this.makeKey(n)}emit(){if(this.lines.push(`${I.Symbols.isConstEnum(this.type)?"const ":""}enum ${this.name} {`),this.increaseIndent(),this.type.exports!==void 0){let e=0,t=this.type.exports.size-1;for(let[n,o]of this.type.exports){let r=o.declarations;if(r===void 0)continue;let d=r[0];if(L.isEnumMember(d)){let a=ie.getLines(d);e<t&&(a[a.length-1]+=","),this.lines.push(...a)}e++}}this.decreaseIndent(),this.lines.push("}")}},qe=class extends Ce{key;constructor(e,t,n,o){super(e,t,n,o)}emit(){this.lines.push(`type ${this.name} = {`),this.increaseIndent(),this.type.members!==void 0&&this.processMembers(this.type.members),this.decreaseIndent(),this.lines.push("}")}},mt=class extends ue{func;name;constructor(e,t,n,o){super(e,t),this.func=n,this.name=o??n.getName()}get key(){}emit(e){let t=this.func.declarations;if(t!==void 0)for(let n of t){let o=n.getSourceFile().fileName;o!==e.fileName&&L.isFunctionDeclaration(n)&&(this.addFunctionDeclaration(n,this.name,"declare"),this.additionalSources.add(o))}}},ft=class extends ue{module;seen;name;constructor(e,t,n,o,r){super(e,t),this.module=n,this.seen=o,this.name=r??n.getName()}get key(){}emit(e){this.lines.push(`declare namespace ${this.name} {`),this.increaseIndent();let t=this.module.exports;t!==void 0&&this.addExports(t,e),this.decreaseIndent(),this.lines.push("}")}addExports(e,t){for(let[n,o]of e){if(this.seen.has(o))continue;let r=o.declarations;if(r!==void 0&&I.Symbols.isFunction(o))for(let d of r){let a=d.getSourceFile().fileName;a!==t.fileName&&L.isFunctionDeclaration(d)&&(this.addFunctionDeclaration(d,void 0,"declare"),this.additionalSources.add(a),this.seen.add(o))}}}},B=class extends ge{lines;source;additionalSources;indent=0;session;symbols;currentSourceFile;seen;constructor(e,t,n,o){super(),this.lines=[],this.source=void 0,this.additionalSources=new Set,this.session=e,this.symbols=t,this.currentSourceFile=n,this.seen=o}getSymbolInfo(e){let t=super.getSymbolInfo(e);return t.skip===!1&&t.primary.fileName===this.currentSourceFile.fileName?{skip:!0}:t}increaseIndent(){this.indent++}decreaseIndent(){this.indent--}getProgram(){return this.symbols.getProgram()}addSource(e){this.source===void 0?this.source=e:this.additionalSources.add(e)}addAdditionalSource(e){if(e!==void 0)for(let t of e)this.additionalSources.add(t)}isEmpty(){return this.lines.length===0||this.source===void 0}snippet(e,t,n,o){if(this.source===void 0)throw new A("No source",A.NoSourceFile);return this.additionalSources.delete(this.source),be.create(this.source,this.additionalSources.size===0?void 0:[...this.additionalSources],this.lines.join(`
`),e,t,n,o)}addDeclaration(e){let t=e.getSourceFile();if(t.fileName===this.currentSourceFile.fileName||this.skipDeclaration(e,t))return;let n=ie.getLines(e,t);this.indent===0?this.lines.push(...n):this.lines.push(...n.map(o=>`${"	".repeat(this.indent)}${o})`)),this.addSource(t.fileName)}addClassSymbol(e,t,n=!0,o=!1){if(!I.Symbols.isClass(e)||this.seen.manages(e))return;let r=this.getSymbolInfo(e);r.skip||this.addEmitter(new Le(this.session,this.symbols,r.primary,e,t,n,o))}addTypeLiteralSymbol(e,t){if(!I.Symbols.isTypeLiteral(e)||this.seen.manages(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new qe(this.session,n.primary,e,t))}addInterfaceSymbol(e,t){if(!I.Symbols.isInterface(e)||this.seen.manages(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new Be(this.session,this.symbols,n.primary,e,t))}addTypeAliasSymbol(e,t){if(!I.Symbols.isTypeAlias(e)||this.seen.manages(e))return;let n=this.getTypeToEmit(e);if(n===void 0||this.seen.manages(n))return;let o=this.getSymbolInfo(n);if(o.skip)return;let r=o.primary;I.Symbols.isClass(n)?this.addEmitter(new Le(this.session,this.symbols,r,n,t,!0,!1)):I.Symbols.isInterface(n)?this.addEmitter(new Be(this.session,this.symbols,r,n,t)):I.Symbols.isTypeLiteral(n)&&this.addEmitter(new qe(this.session,r,n,t))}addEnumSymbol(e,t){if(!I.Symbols.isEnum(e)||this.seen.manages(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new pt(this.session,n.primary,e,t))}addFunctionSymbol(e,t){if(!I.Symbols.isFunction(e)||this.seen.manages(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new mt(this.session,n.primary,e,t))}addModuleSymbol(e,t){if(!I.Symbols.isValueModule(e)||this.seen.manages(e))return;let n=this.getSymbolInfo(e);n.skip||this.addEmitter(new ft(this.session,n.primary,e,this.seen,t))}addTypeSymbol(e,t){if(t===void 0&&I.Symbols.isInternal(e))return;let n=t??e.getName();I.Symbols.isClass(e)?this.addClassSymbol(e,n):I.Symbols.isInterface(e)?this.addInterfaceSymbol(e,n):I.Symbols.isTypeAlias(e)?this.addTypeAliasSymbol(e,n):I.Symbols.isEnum(e)?this.addEnumSymbol(e,n):I.Symbols.isFunction(e)?this.addFunctionSymbol(e,n):I.Symbols.isValueModule(e)?this.addModuleSymbol(e,n):I.Symbols.isTypeLiteral(e)&&n!==void 0&&this.addTypeLiteralSymbol(e,n)}addEmitter(e){let t,n,o;if(e.key!==void 0){let r=this.session.getCachedCode(e.key);r!==void 0&&(t=r.value,n=r.uri,o=r.additionalUris)}(t===void 0||n===void 0)&&(e.emit(this.currentSourceFile),t=e.lines,n=e.source,o=e.getAdditionalSources(),e.key!==void 0&&this.session.cacheCode(e.key,{value:t,uri:n,additionalUris:o})),this.indent===0?this.lines.push(...t):this.lines.push(...t.map(r=>`${"	".repeat(this.indent)}${r}`)),this.addSource(n),this.addAdditionalSource(o)}getTypeToEmit(e){if(!I.Symbols.isTypeAlias(e))return;let t=e.declarations;if(t!==void 0){for(let n of t)if(L.isTypeAliasDeclaration(n)){let o=n.type;if(L.isTypeLiteralNode(o)){let r=this.symbols.getSymbolAtLocation(o);if(I.Symbols.isTypeLiteral(r))return r}else if(L.isTypeReferenceNode(o)){let r=this.symbols.getLeafSymbolAtLocation(o.typeName);if(I.Symbols.isInterface(r)||I.Symbols.isTypeLiteral(r)||I.Symbols.isTypeLiteral(r))return r}}}}}});var pe,R,_e,ve,yt,re,se,ae,de,me,fe=J(()=>{"use strict";H();Te();ne();W();pe=ee(te()),R=N(),_e=class p extends j{static traitsToCollect=[["module","The TypeScript module system used in this project is ",.5,X.makeContextItemKey("module"),R.ModuleKind],["moduleResolution","The TypeScript module resolution strategy used in this project is ",.5,X.makeContextItemKey("moduleResolution"),R.ModuleResolutionKind],["target","The target version of JavaScript for this project is ",.5,X.makeContextItemKey("target"),R.ScriptTarget],["lib","Library files that should be included in TypeScript compilation are ",.5,X.makeContextItemKey("lib"),void 0]];document;constructor(e,t,n,o){super(e,t,n,.5,1),this.document=o}compute(e,t){t.throwIfCancellationRequested();let n=this.getProgram().getCompilerOptions(),o=this.context,r=o.getCachedContextItem(X.makeContextItemKey("version"));r!==void 0?e.addCachedContextItem(r):e.addTrait("version",.5,"The TypeScript version used in this project is ",R.version,this.document);for(let[d,a,u,l,b]of p.traitsToCollect){let S=o.getCachedContextItem(l);if(S!==void 0)e.addCachedContextItem(S);else{let x=n[d];if(x){if(typeof x=="number"){let v=p.getEnumName(b,x);v&&(x=v)}e.addTrait(d,u,a,x.toString(),this.document)}}}}static getEnumName(e,t){return Object.keys(e).find(n=>e[n]===t)}},ve=class extends j{declaration;sourceFile;constructor(e,t,n,o,r,d){super(e,t,n,r,d),this.declaration=o,this.sourceFile=o.getSourceFile()}getCacheScope(){let e=this.declaration.body;if(!(e===void 0||!R.isBlock(e)))return super.createCacheScope(e,this.sourceFile)}},yt=class extends ve{constructor(e,t,n,o,r=1){super(e,t,n,o,r,1)}compute(e,t){let n=this.getCacheScope(),o=this.getSeenSymbols(),r=this.declaration.parameters;for(let a=0;a<r.length;a++){t.throwIfCancellationRequested();let l=this.declaration.parameters[a].type;l!==void 0&&this.processType(e,l,o,n)}let d=this.declaration.type;d!==void 0&&(t.throwIfCancellationRequested(),this.processType(e,d,o,n))}processType(e,t,n,o){let r=this.getSymbolsToEmitForTypeNode(t);if(r.length!==0)for(let d of r){let a=d.symbol,[u,l]=this.handleSymbolIfCachedOrSeen(e,a,"clientBased",o);if(u)continue;let b=new B(this.session,this.symbols,this.sourceFile,n);b.addTypeSymbol(a,d.name),e.addSnippet(b,"signature",this.priority,"emit",l),n.add(a)}}},re=class extends j{tokenInfo;excludes;cacheScope;constructor(e,t,n,o,r,d,a=1){super(e,t,n,a,2),this.tokenInfo=o,this.excludes=r,this.cacheScope=d}compute(e,t){t.throwIfCancellationRequested();let n=this.tokenInfo.previous??this.tokenInfo.token??this.tokenInfo.touching,r=this.symbols.getTypeChecker(),d=r.getSymbolsInScope(n,R.SymbolFlags.BlockScopedVariable);if(d.length===0)return;let a=n.getSourceFile(),u=this.getSeenSymbols();for(let l of d){if(t.throwIfCancellationRequested(),u.has(l)||this.excludes.has(l))continue;let b=pe.Symbols.getPrimarySourceFile(l);if(b!==a||this.skipSourceFile(b))continue;let S=pe.Symbols.getDeclaration(l,R.SyntaxKind.VariableDeclaration);if(S===void 0)continue;let x;if(S.type!==void 0)x=this.getSymbolsToEmitForTypeNode(S.type);else{let v=r.getTypeAtLocation(S.type??S);v!==void 0&&(x=this.getSymbolsToEmitForType(v))}if(!(x===void 0||x.length===0)){for(let v of x){t.throwIfCancellationRequested();let D=v.symbol,[V,Q]=this.handleSymbolIfCachedOrSeen(e,D,"clientBasedOnTimeout",this.cacheScope);if(V)continue;let q=new B(this.session,this.symbols,a,u);q.addTypeSymbol(D,v.name),e.addSnippet(q,"completion",this.priority,"emit",Q),u.add(D)}u.add(l)}}}},se=class extends j{tokenInfo;cacheScope;constructor(e,t,n,o,r,d=.55){super(e,t,n,d,2),this.tokenInfo=o,this.cacheScope=r}compute(e,t){if(e.tokenBudget.isExhausted())return;t.throwIfCancellationRequested();let n=this.symbols,o=this.getSeenSymbols(),d=(this.tokenInfo.previous??this.tokenInfo.token??this.tokenInfo.touching).getSourceFile();for(let a of this.context.neighborFiles){if(t.throwIfCancellationRequested(),e.tokenBudget.isExhausted())return;let u=this.getProgram().getSourceFile(a);if(u===void 0||this.skipSourceFile(u))continue;let l=n.getSymbolAtLocation(u);if(!(l===void 0||o.has(l))&&l.exports!==void 0)for(let b of l.exports){t.throwIfCancellationRequested();let S=b[1];if((S.flags&(R.SymbolFlags.Class|R.SymbolFlags.Interface|R.SymbolFlags.TypeAlias|R.SymbolFlags.Enum|R.SymbolFlags.Function))===0)continue;let[x,v]=this.handleSymbolIfCachedOrSeen(e,S,"clientBasedOnTimeout",this.cacheScope);if(x)continue;let D=new B(this.session,this.symbols,d,o);if(D.addTypeSymbol(S,b[0]),o.add(S),!e.addSnippet(D,"neighborFile",.55,"emit",v,!0))return}}}},ae=class extends j{tokenInfo;excludes;cacheScope;constructor(e,t,n,o,r,d,a=.4){super(e,t,n,a,2),this.tokenInfo=o,this.excludes=r,this.cacheScope=d}compute(e,t){if(t.throwIfCancellationRequested(),e.tokenBudget.isExhausted())return;let n=this.tokenInfo.previous??this.tokenInfo.token??this.tokenInfo.touching,d=this.symbols.getTypeChecker().getSymbolsInScope(n,R.SymbolFlags.Class|R.SymbolFlags.Interface|R.SymbolFlags.TypeAlias|R.SymbolFlags.Enum|R.SymbolFlags.Alias);if(d.length===0)return;let a=n.getSourceFile(),u=this.getSeenSymbols();for(let l of d){if(t.throwIfCancellationRequested(),this.excludes.has(l))continue;let b=pe.Symbols.getPrimarySourceFile(l);if(b===void 0||this.skipSourceFile(b))continue;let S=l,x=l.name;if(pe.Symbols.isAlias(l)){let q=this.symbols.getLeafAliasedSymbol(l);q!==void 0&&(q.flags&(R.SymbolFlags.Class|R.SymbolFlags.Interface|R.SymbolFlags.TypeAlias|R.SymbolFlags.Enum))!==0?S=q:S=void 0}if(S===void 0||this.excludes.has(S))continue;if(S!==l){let q=pe.Symbols.getPrimarySourceFile(S);if(q===void 0||this.skipSourceFile(q)||q===a)continue}else if(b===a)continue;let[v,D]=this.handleSymbolIfCachedOrSeen(e,S,"clientBasedOnTimeout",this.cacheScope);if(v)continue;let V=new B(this.session,this.symbols,a,u);V.addTypeSymbol(S,x);let Q=!e.addSnippet(V,"generalScope",this.priority,"emit",D,!0);if(u.add(S),Q)break}}},de=class p extends j{expression;constructor(e,t,n,o,r=1){super(e,t,n,r,1),this.expression=o}static create(e,t,n,o,r){let d=o.previous;if(!(d===void 0||d.parent===void 0)&&(R.isIdentifier(d)||d.kind===R.SyntaxKind.DotToken)&&R.isPropertyAccessExpression(d.parent)){let a=this.getRightMostIdentifier(d.parent.expression,0);if(a!==void 0)return new p(e,t,n,a)}}static getRightMostIdentifier(e,t){if(t!==32)switch(e.kind){case R.SyntaxKind.Identifier:return e;case R.SyntaxKind.PropertyAccessExpression:return this.getRightMostIdentifier(e.name,t+1);case R.SyntaxKind.ElementAccessExpression:return this.getRightMostIdentifier(e.argumentExpression,t+1);case R.SyntaxKind.CallExpression:return this.getRightMostIdentifier(e.expression,t+1);default:return}}compute(e,t){t.throwIfCancellationRequested();let n=this.symbols.getLeafSymbolAtLocation(this.expression);if(n===void 0)return;let o=this.symbols.getTypeChecker(),r=this.getSeenSymbols();if(r.has(n))return;let d=o.getTypeOfSymbolAtLocation(n,this.expression),a=d.getConstructSignatures().concat(d.getCallSignatures()),u=this.expression.getSourceFile();for(let S of a){t.throwIfCancellationRequested();let x=S.getReturnType(),v=x.aliasSymbol??x.getSymbol();if(v===void 0||r.has(v))continue;let D=new B(this.session,this.symbols,u,r);D.addTypeSymbol(v,v.name),e.addSnippet(D,"completion",this.priority,"ignore")}let l=d.getSymbol();if(l===void 0||r.has(l))return;let b=new B(this.session,this.symbols,u,r);b.addTypeSymbol(l,l.name),e.addSnippet(b,"completion",this.priority,"ignore"),r.add(l)}},me=class extends ${functionLikeDeclaration;tokenInfo;computeContext;isCallableProvider;cacheScope;constructor(e,t,n,o,r){super(e,t),this.functionLikeDeclaration=n,this.tokenInfo=o,this.computeContext=r,this.isCallableProvider=!0,this.cacheScope=ce.fromDeclaration(n)}getCallableCacheScope(){return this.cacheScope}provide(e,t,n,o,r){if(r.throwIfCancellationRequested(),e.addPrimary(new yt(t,n,o,this.functionLikeDeclaration)),!this.computeContext.isFirstCallableProvider(this))return;let d=this.getTypeExcludes(n,o);e.addPrimary(new re(t,n,o,this.tokenInfo,d,ce.fromDeclaration(this.functionLikeDeclaration)));let a=de.create(t,n,o,this.tokenInfo,r);a!==void 0&&e.addPrimary(a),e.addSecondary(new ae(t,n,o,this.tokenInfo,d,this.cacheScope)),e.addTertiary(new se(t,n,o,this.tokenInfo,this.cacheScope))}}});var Z,le,xt,Oe,Ct,Ve,Tt,Vt=J(()=>{"use strict";H();Te();ne();W();Z=ee(te()),le=N(),xt=class p extends G{classDeclaration;stateProvider;abstractMembers;extends;implements;constructor(e,t,n,o){if(super(e,t),n instanceof p){let r=n;this.classDeclaration=G.getNodeInProgram(e,r.classDeclaration),this.stateProvider=r.stateProvider,this.abstractMembers=r.abstractMembers;let d=a=>{let u=a.type,l=e.getSourceFile(u.getSourceFile().fileName);if(l!==void 0){let b=Z.default.getTokenAtPosition(l,u.pos);if(le.isExpressionWithTypeArguments(b)){let S=t.getSymbolAtLocation(b.expression);if(S!==void 0&&!this.getSymbolInfo(S).skip)return{symbol:S,type:b,abstractMembers:a.abstractMembers}}}};if(r.extends!==void 0&&(this.extends=d(r.extends)),r.implements!==void 0){let a;for(let u of r.implements){let l=d(u);l!==void 0&&(a=a??[],a.push(l))}this.implements=a}}else{let r=n;this.classDeclaration=r,this.stateProvider=o;let d=r.heritageClauses;if(d===void 0){this.abstractMembers=0,this.extends=void 0,this.implements=void 0;return}let a=0,u,l;for(let b of d)if(b.token===le.SyntaxKind.ExtendsKeyword){if(b.types.length===1){let S=b.types[0],x=this.getHeritageSymbol(S.expression);if(x!==void 0&&!this.getSymbolInfo(x).skip){let v=this.getNumberOfAbstractMembers(x);a+=v,u={symbol:x,type:S,abstractMembers:v}}}}else if(b.token===le.SyntaxKind.ImplementsKeyword)for(let S of b.types){let x=this.getHeritageSymbol(S.expression);if(x!==void 0&&!this.getSymbolInfo(x).skip){l=l??[];let v=this.getNumberOfAbstractMembers(x);a+=v,l.push({symbol:x,type:S,abstractMembers:v})}}l!==void 0&&l.sort((b,S)=>S.abstractMembers-b.abstractMembers),this.abstractMembers=a,this.extends=u,this.implements=l}}with(e){return e===this.program?this:new p(e,new Z.Symbols(e),this)}*all(){this.extends!==void 0&&(yield this.extends),this.implements!==void 0&&(yield*this.implements)}isSame(e){return this.classDeclaration===e||this.classDeclaration.getSourceFile().fileName===e.getSourceFile().fileName&&this.classDeclaration.pos===e.pos}score(e,t){if(this.abstractMembers===0){if(this.extends===void 0)return-1;let a=this.extends.symbol.declarations;if(a===void 0)return-1;for(let u of a)if(e.getSourceFile(u.getSourceFile().fileName)===void 0)return-1;return 1}let n;for(let a of this.all())if(a.symbol.declarations!==void 0)for(let u of a.symbol.declarations){let l=u.getSourceFile();if(e.getSourceFile(l.fileName)!==void 0){n??=0,n+=a.abstractMembers;break}}if(n===void 0)return-1;let o=n/this.abstractMembers,r=t.neighborFiles;if(r.length===0)return o;let d=Math.pow(10,r.length.toString().length);o*=d;for(let a of r)e.getSourceFile(a)!==void 0&&(o+=1);return o}run(e,t){if(this.extends===void 0&&this.implements===void 0)return;let n,o=new Map([...this.all()].map(r=>[r.symbol,r]));for(let r of this.all()){let a=r.symbol.declarations;if(a===void 0)continue;let u=new Set;for(let l of a){if(!le.isClassDeclaration(l)&&!le.isInterfaceDeclaration(l)&&!le.isTypeAliasDeclaration(l)||l.name===void 0)continue;let b=l.getSourceFile();if(u.has(b.fileName))continue;let S=new Z.ReferencedByVisitor(this.program,b,e.getPreferredNeighborFiles(this.program),this.stateProvider,t);for(let x of S.entries()){t.throwIfCancellationRequested();for(let v of Z.ClassDeclarations.entries(x)){if(v.heritageClauses===void 0||this.isSame(v))continue;let D;for(let V of v.heritageClauses)for(let Q of V.types){let q=this.getHeritageSymbol(Q.expression);if(q===void 0)continue;let Y=o.get(q);Y!==void 0&&(D??=0,D+=Y.abstractMembers)}if(D!==void 0&&(n===void 0?n={declaration:v,matchesAbstractMembers:D}:D>n.matchesAbstractMembers&&(n={declaration:v,matchesAbstractMembers:D})),n!==void 0&&n.matchesAbstractMembers===this.abstractMembers)return n}}}}}getNumberOfAbstractMembers(e){return this.symbols.getMemberStatistic(e).abstract.size}},Oe=class extends j{classDeclaration;constructor(e,t,n,o,r=.9){super(e,t,n,r,2),this.classDeclaration=o}compute(e,t){t.throwIfCancellationRequested();let n=this.symbols,o=n.getSymbolAtLocation(this.classDeclaration.name??this.classDeclaration);if(o===void 0||!Z.Symbols.isClass(o)||o.declarations===void 0)return;let r=this.getSeenSymbols(),[d,a]=n.getExtendsSymbol(o);if(d!==void 0&&a!==void 0){let u=this.createCacheScope(this.classDeclaration.members,this.classDeclaration.getSourceFile()),[l,b]=this.handleSymbolIfCachedOrSeen(e,d,"clientBased",u);if(l)return;let S=this.classDeclaration.getSourceFile(),x=new B(this.session,n,S,r);x.addClassSymbol(d,a,!0,!1),e.addSnippet(x,"superClass",this.priority,"emit",b),r.add(d)}}},Ct=class extends j{classDeclaration;constructor(e,t,n,o,r=.7){super(e,t,n,r,3),this.classDeclaration=o}compute(e,t){t.throwIfCancellationRequested();let n=this.getProgram(),o=this.classDeclaration,r=this.symbols.getSymbolAtLocation(o.name??o);if(r===void 0||!Z.Symbols.isClass(r))return;let d=new xt(n,this.symbols,o);if(d.extends===void 0&&d.implements===void 0)return;let[a,u]=this.session.run(d,this.context,t);if(a===void 0||u===void 0)return;let l=new B(this.session,this.context.getSymbols(a),o.getSourceFile(),this.getSeenSymbols());l.addDeclaration(u.declaration),e.addSnippet(l,"blueprint",this.priority,"emit",void 0)}},Ve=class p extends ${static create(e,t){return e.members===void 0||e.members.length===0?new Tt(e,t):new p(e,t)}classDeclaration;constructor(e,t){super("class"),this.classDeclaration=e}provide(e,t,n,o,r){r.throwIfCancellationRequested(),e.addPrimary(new Oe(t,n,o,this.classDeclaration))}},Tt=class extends ${classDeclaration;constructor(e,t){super("wholeClass",le.SymbolFlags.Function),this.classDeclaration=e}getImportsByCacheRange(){return this._getImportsByCacheRange(this.classDeclaration)}provide(e,t,n,o,r){r.throwIfCancellationRequested(),e.addPrimary(new Oe(t,n,o,this.classDeclaration)),t.enableBlueprintSearch()&&e.addPrimary(new Ct(t,n,o,this.classDeclaration))}}});var jt,ye,Jt=J(()=>{"use strict";H();fe();W();jt=N(),ye=class extends me{functionDeclaration;constructor(e,t,n){super("function",jt.SymbolFlags.Function|jt.SymbolFlags.ValueModule,e,t,n),this.functionDeclaration=e}provide(e,t,n,o,r){super.provide(e,t,n,o,r)}getTypeExcludes(){return new Set}}});var k,M,je,Ie,Je,vt,Kt,It,He,kt,Ge,Ft,Ue,wt,Dt,ze,Ht=J(()=>{"use strict";H();fe();Te();ne();W();k=ee(te()),M=N(),je=class extends G{declaration;stateProvider;constructor(e,t,n,o){super(e,t),this.declaration=n,this.stateProvider=o}isSame(e){return this.declaration===e||this.declaration.getSourceFile().fileName===e.getSourceFile().fileName&&this.declaration.pos===e.pos}score(e,t){if(e.getSourceFile(this.declaration.getSourceFile().fileName)===void 0)return 0;let n=t.neighborFiles;if(n.length===0)return 1;let o=Math.pow(10,n.length.toString().length);for(let r of n)e.getSourceFile(r)!==void 0&&(o+=1);return o}},Ie=class extends je{constructor(e,t,n,o){super(e,t,n,o)}static create(e,t,n,o){let r=n.parent;if(!M.isClassDeclaration(r))return;let d=k.Declarations.isPrivate(n),a=[],u;if(!d){let l=t.getSymbolAtLocation(r.name!==void 0?r.name:r);if(l===void 0||!k.Symbols.isClass(l))return;let b=M.escapeLeadingUnderscores(n.name.getText()),S,x=!1;for(let[v,D]of t.getAllSuperTypesWithPath(l)){if(l===v&&(x=!1,S=[]),x)continue;S.push(D);let V=D.members?.get(b);if(V!==void 0){if(k.Symbols.isInterface(D)||k.Symbols.isTypeLiteral(D))a.push(...S),x=!0;else if(k.Symbols.isClass(D))if(k.Symbols.isAbstract(V)){u=D;break}else{u=D;break}}}}if(d){let l=k.ClassDeclarations.getExtendsClause(r);if(l===void 0||l.types.length===0)return;{let b=t.getLeafSymbolAtLocation(l.types[0].expression);return b===void 0||!k.Symbols.isClass(b)?void 0:new vt(e,t,r,b,n,o)}}else{if(u!==void 0)return new Kt(e,t,r,n,u,o);if(a.length>0){let l=a.filter(b=>{if(k.Symbols.isTypeLiteral(b))return!1;let S=b.escapedName;return!(S==="__type"||S==="__class")});return new It(e,t,r,n,l,o)}else return}}},Je=class p extends je{classDeclaration;extendsSymbol;constructor(e,t,n,o,r,d){if(n instanceof p){let a=n,u=G.getNodeInProgram(e,a.declaration);super(e,t,u,a.stateProvider),this.classDeclaration=G.getNodeInProgram(e,a.classDeclaration);let l=a.extendsSymbol.declarations;if(l===void 0||l.length===0)throw new Error("No declarations found for extends symbol");let b;for(let S of l)if(M.isClassDeclaration(S)){let x=k.ClassDeclarations.getExtendsClause(S);if(x===void 0||x.types.length===0)throw new Error("No extends clause found");if(b=this.symbols.getSymbolAtLocation(x.types[0].expression),b===void 0||!k.Symbols.isClass(b))throw new Error("No extends symbol found");break}if(b===void 0)throw new Error("No extends symbol found");this.extendsSymbol=b}else super(e,t,r,d),this.classDeclaration=n,this.extendsSymbol=o}run(e,t){let n=this.getMemberName();for(let o of this.symbols.getDirectSubTypes(this.extendsSymbol,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),o.members!==void 0){let r=o.members.get(n);if(r===void 0)continue;let d=r.declarations;if(d===void 0||d.length===0)continue;for(let a of d){if(a.kind!==this.declaration.kind)continue;let u=a.parent;if(!(!M.isClassDeclaration(u)||u===this.classDeclaration))return u}}}},vt=class p extends Je{constructor(e,t,n,o,r,d){n instanceof p?super(e,t,n):super(e,t,n,o,r,d)}with(e){return e===this.program?this:new p(e,new k.Symbols(e),this)}getMemberName(){return M.escapeLeadingUnderscores(this.declaration.name.getText())}},Kt=class p extends Ie{classDeclaration;startClass;constructor(e,t,n,o,r,d){if(n instanceof p){let a=n,u=G.getNodeInProgram(e,a.declaration);super(e,t,u,a.stateProvider),this.classDeclaration=G.getNodeInProgram(e,a.classDeclaration);let b=a.startClass.declarations;if(b===void 0||b.length===0)throw new A("No declarations found for start class",A.NoDeclaration);let S;for(let x of b)if(M.isClassDeclaration(x)&&(S=this.symbols.getSymbolAtLocation(x.name?x.name:x),S!==void 0))break;if(S===void 0)throw new A("No symbol found for start class",A.SymbolNotFound);this.startClass=S}else super(e,t,o,d),this.classDeclaration=n,this.startClass=r}with(e){return e===this.program?this:new p(e,new k.Symbols(e),this)}run(e,t){if(!k.Symbols.isClass(this.startClass))return;let n=M.escapeLeadingUnderscores(this.declaration.name.getText());for(let o of this.symbols.getAllSubTypes(this.startClass,k.Traversal.breadthFirst,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),o.members!==void 0){let r=o.members.get(n);if(r===void 0)continue;let d=r.declarations;if(d===void 0||d.length===0)continue;for(let a of d){if(!M.isMethodDeclaration(a))continue;let u=a.parent;if(!(!M.isClassDeclaration(u)||u===this.classDeclaration))return u}}}},It=class p extends Ie{classDeclaration;typesToCheck;constructor(e,t,n,o,r,d){if(n instanceof p){let a=n,u=G.getNodeInProgram(e,a.declaration);super(e,t,u,a.stateProvider),this.classDeclaration=G.getNodeInProgram(e,a.classDeclaration);let l=[];for(let b of a.typesToCheck){let S=b.declarations;if(S===void 0||S.length===0)throw new A("No declarations found for start class",A.NoDeclaration);let x;for(let v of S)if(!(!M.isClassDeclaration(v)&&!M.isInterfaceDeclaration(v))&&(x=this.symbols.getSymbolAtLocation(v.name?v.name:v),x!==void 0&&x.flags===b.flags))break;if(x===void 0)throw new A("No symbol found for start class",A.SymbolNotFound);l.push(x)}this.typesToCheck=l}else super(e,t,o,d),this.classDeclaration=n,this.typesToCheck=r}with(e){return e===this.program?this:new p(e,new k.Symbols(e),this)}run(e,t){let n=M.escapeLeadingUnderscores(this.declaration.name.getText()),o=new Set(this.typesToCheck),r=[];for(let a of this.typesToCheck){t.throwIfCancellationRequested();for(let u of this.symbols.getDirectSubTypes(a,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),!o.has(u)){if(k.Symbols.isClass(u)){let l=u.members?.get(n);if(l!==void 0&&!k.Symbols.isAbstract(l)){let b=k.ClassDeclarations.fromSymbol(u);if(b===this.classDeclaration)continue;if(b!==void 0)return b}}r.push(u)}}let d=new Set;for(let a of r)if(t.throwIfCancellationRequested(),!d.has(a)){for(let u of this.symbols.getAllSubTypes(a,k.Traversal.breadthFirst,e.getPreferredNeighborFiles(this.program),this.stateProvider,t))if(t.throwIfCancellationRequested(),!d.has(u)){if(k.Symbols.isClass(u)){let l=u.members?.get(n);if(l!==void 0&&!k.Symbols.isAbstract(l)){let b=k.ClassDeclarations.fromSymbol(u);if(b===this.classDeclaration){d.add(u);continue}if(b!==void 0)return b}}d.add(u)}d.add(a)}}},He=class extends ve{constructor(e,t,n,o,r=.7){super(e,t,n,o,r,3)}compute(e,t){t.throwIfCancellationRequested();let n=this.createSearch(t);if(n!==void 0){let[o,r]=this.session.run(n,this.context,t);if(o!==void 0&&r!==void 0){let d=this.symbols.getLeafSymbolAtLocation(r.name?r.name:r);if(d===void 0)return;let a=this.getSeenSymbols();if(a.has(d))return;let u=this.declaration.getSourceFile(),l=new B(this.session,this.context.getSymbols(o),u,a);l.addDeclaration(r),e.addSnippet(l,"blueprint",this.priority,"emit",void 0),a.add(d)}}}},kt=class extends He{constructor(e,t,n,o){super(e,t,n,o)}createSearch(){return Ie.create(this.getProgram(),this.symbols,this.declaration,this.session)}},Ge=class extends me{declaration;isCallableProvider;constructor(e,t,n,o,r){super(e,t,n,o,r),this.declaration=n,this.isCallableProvider=!0}getImportsByCacheRange(){let e=this.declaration.parent;return M.isClassDeclaration(e)?this._getImportsByCacheRange(e):void 0}getTypeExcludes(e,t){let n=new Set,o=this.declaration.parent;if(M.isClassDeclaration(o)&&o.heritageClauses!==void 0&&o.heritageClauses.length>0){let r=e.getProgram();if(r!==void 0){let d=t.getSymbols(r);for(let a of o.heritageClauses)if(a.token===M.SyntaxKind.ExtendsKeyword)for(let u of a.types){let l=d.getSymbolAtLocation(u.expression);if(l!==void 0&&k.Symbols.isClass(l))return n.add(l)}}}return n}},Ft=class p extends j{declaration;constructor(e,t,n,o,r=.8){super(e,t,n,r,2),this.declaration=o}compute(e,t){let n=this.declaration.parent;if(!M.isClassDeclaration(n))return;let r=this.getProgram(),d=this.context.getSymbols(r),a=this.getSeenSymbols(),u=d.getSymbolAtLocation(this.declaration.name?this.declaration.name:this.declaration);if(u===void 0||!k.Symbols.isMethod(u))return;let l=d.getSymbolAtLocation(n.name?n.name:n);if(l===void 0||!k.Symbols.isClass(l))return;let b=this.createCacheScope(this.declaration);if(l.members!==void 0){for(let S of l.members.values())if(t.throwIfCancellationRequested(),S!==u&&!this.handleSymbol(e,S,d,a,M.ModifierFlags.Private|M.ModifierFlags.Protected,b))return}for(let S of d.getAllSuperClasses(l))if(t.throwIfCancellationRequested(),S.members!==void 0){for(let x of S.members.values())if(t.throwIfCancellationRequested(),!this.handleSymbol(e,x,d,a,M.ModifierFlags.Protected,b))return}}handleSymbol(e,t,n,o,r,d){if(o.has(t)||!k.Symbols.hasModifierFlags(t,r))return!0;let a=this.declaration.getSourceFile(),u=!0;for(let[l,b]of this.getEmitData(t,n)){if(l===void 0)continue;let[S,x]=this.handleSymbolIfCachedOrSeen(e,l,"clientBased",d);if(!S){let v=new B(this.session,this.symbols,a,o);v.addTypeSymbol(l,b),u=u&&e.addSnippet(v,"completion",this.priority,"emit",x,!0),o.add(l)}if(!u)break}return u}static NoEmitData=Object.freeze([void 0,void 0]);*getEmitData(e,t){if(k.Symbols.isProperty(e)){let o=t.getTypeChecker().getTypeOfSymbol(e).symbol;if(o===void 0)return;let r,d=k.Symbols.getDeclaration(e,M.SyntaxKind.PropertyDeclaration);d!==void 0&&d.type!==void 0&&(r=k.default.Nodes.getTypeName(d.type)),yield[o,r];return}else if(k.Symbols.isMethod(e)){let o=t.getTypeChecker().getTypeOfSymbol(e).getCallSignatures();if(o.length===0)return;for(let r of o){let d=r.getReturnType().symbol;d===void 0&&(yield p.NoEmitData);let a,u=r.getDeclaration();u!==void 0&&u.type!==void 0&&(a=k.default.Nodes.getTypeName(u.type)),yield[d,a]}}}},Ue=class extends Ge{constructor(e,t,n){super(e.body===void 0||e.body.statements.length===0?"wholeMethod":"method",M.SymbolFlags.Function,e,t,n)}provide(e,t,n,o,r){t.enableBlueprintSearch()&&e.addPrimary(new kt(t,n,o,this.declaration)),super.provide(e,t,n,o,r),e.addSecondary(new Ft(t,n,o,this.declaration))}},wt=class p extends Je{constructor(e,t,n,o,r,d){n instanceof p?super(e,t,n):super(e,t,n,o,r,d)}with(e){return e===this.program?this:new p(e,new k.Symbols(e),this)}getMemberName(){return M.InternalSymbolName.Constructor}},Dt=class extends He{constructor(e,t,n,o){super(e,t,n,o)}createSearch(){let e=this.declaration.parent;if(!M.isClassDeclaration(e))return;let t=k.ClassDeclarations.getExtendsClause(e);if(!(t===void 0||t.types.length===0)){let n=this.symbols.getLeafSymbolAtLocation(t.types[0].expression);return n===void 0||!k.Symbols.isClass(n)?void 0:new wt(this.getProgram(),this.symbols,e,n,this.declaration,this.session)}}},ze=class extends Ge{constructor(e,t,n){super(e.body===void 0||e.body.statements.length===0?"wholeConstructor":"constructor",M.SymbolFlags.Function,e,t,n)}provide(e,t,n,o,r){t.enableBlueprintSearch()&&e.addPrimary(new Dt(t,n,o,this.declaration)),super.provide(e,t,n,o,r)}}});var gn,Qe,Gt=J(()=>{"use strict";H();fe();ne();W();gn=N(),Qe=class extends ${declaration;tokenInfo;computeInfo;isCallableProvider;constructor(e,t,n){super("sourceFile",gn.SymbolFlags.Function),this.declaration=e,this.tokenInfo=t,this.computeInfo=n,this.isCallableProvider=!0}provide(e,t,n,o,r){if(r.throwIfCancellationRequested(),!this.computeInfo.isFirstCallableProvider(this))return;let d=new Set;e.addPrimary(new re(t,n,o,this.tokenInfo,d,void 0));let a=de.create(t,n,o,this.tokenInfo,r);a!==void 0&&e.addPrimary(a),e.addSecondary(new ae(t,n,o,this.tokenInfo,d,void 0)),e.addTertiary(new se(t,n,o,this.tokenInfo,void 0))}}});var We,he,Pt,$e,Ut=J(()=>{"use strict";H();fe();Te();ne();W();We=ee(te()),he=N(),Pt=class extends j{tokenInfo;symbolsToQuery;cacheScope;constructor(e,t,n,o,r,d){super(e,t,n,.6,2),this.tokenInfo=o,this.symbolsToQuery=r,this.cacheScope=d}compute(e,t){t.throwIfCancellationRequested();let n=this.getProgram(),o=this.symbols,r=this.getSeenSymbols(),d=this.tokenInfo.token.getSourceFile(),a=this.getModulesAndFunctionsInScope(n,o.getTypeChecker(),d);t.throwIfCancellationRequested();for(let u of a.functions.real){t.throwIfCancellationRequested();let[l,b]=this.handleSymbolIfCachedOrSeen(e,u,"clientBasedOnTimeout",this.cacheScope);if(l)continue;let S=new B(this.session,this.symbols,d,r);S.addFunctionSymbol(u),e.addSnippet(S,"generalScope",this.priority,"emit",b),r.add(u)}if(!e.tokenBudget.isExhausted()){for(let{alias:u,real:l}of a.functions.aliased){t.throwIfCancellationRequested();let[b,S]=this.handleSymbolIfCachedOrSeen(e,l,"clientBasedOnTimeout",this.cacheScope);if(b||r.has(u))continue;let x=new B(this.session,this.symbols,d,r);if(x.addFunctionSymbol(l,u.getName()),!e.addSnippet(x,"generalScope",this.priority,"emit",S,!0))break;r.add(u),r.add(l)}if(!e.tokenBudget.isExhausted())for(let{alias:u,real:l}of a.modules){t.throwIfCancellationRequested();let[b,S]=this.handleSymbolIfCachedOrSeen(e,l,"clientBasedOnTimeout",this.cacheScope);if(b||r.has(u))continue;let x=new B(this.session,this.symbols,d,r);if(x.addModuleSymbol(l,u.getName()),!e.addSnippet(x,"generalScope",this.priority,"emit",S,!0))break;r.add(u),r.add(l)}}}getModulesAndFunctionsInScope(e,t,n){let o={functions:{real:[],aliased:[]},modules:[]},r=this.tokenInfo.previous??this.tokenInfo.token,d=t.getSymbolsInScope(r,this.symbolsToQuery|he.SymbolFlags.Alias);for(let a of d){let u=a.declarations;if(u!==void 0)for(let l of u){let b=l.getSourceFile();if(!(e.isSourceFileDefaultLibrary(b)||e.isSourceFileFromExternalLibrary(b))){if(We.Symbols.isFunction(a)&&this.includeFunctions()&&b!==n){o.functions.real.push(a);break}else if(We.Symbols.isAlias(a)){let S=t.getAliasedSymbol(a);if(We.Symbols.isFunction(S)&&this.includeFunctions()){o.functions.aliased.push({alias:a,real:S});break}else if(S.flags===he.SymbolFlags.ValueModule&&this.includeValueModules()){o.modules.push({alias:a,real:S});break}}}}}return o}includeFunctions(){return(this.symbolsToQuery&he.SymbolFlags.Function)!==0}includeValueModules(){return(this.symbolsToQuery&he.SymbolFlags.ValueModule)!==0}},$e=class extends ${tokenInfo;computeInfo;isCallableProvider;constructor(e,t){super("sourceFile",he.SymbolFlags.Function),this.tokenInfo=e,this.computeInfo=t,this.isCallableProvider=!0}provide(e,t,n,o,r){r.throwIfCancellationRequested();let d=this.computeInfo.getSymbolsToQuery(),a=this.computeInfo.getCallableCacheScope();if(d!==void 0&&d!==he.SymbolFlags.None&&e.addSecondary(new Pt(t,n,o,this.tokenInfo,d,a)),!this.computeInfo.isFirstCallableProvider(this))return;e.addPrimary(new re(t,n,o,this.tokenInfo,new Set,void 0));let u=de.create(t,n,o,this.tokenInfo,r);u!==void 0&&e.addPrimary(u),e.addSecondary(new ae(t,n,o,this.tokenInfo,new Set,void 0)),e.addTertiary(new se(t,n,o,this.tokenInfo,void 0))}}});function zt(p,e,t,n,o,r,d,a){let u=t.getProgram();if(u===void 0)return;let l=u.getSourceFile(n);if(l===void 0)return;let b=At.default.getRelevantTokens(l,o);new Nt(n,b,r,d).execute(p,e,t,a)}var At,U,Rt,Nt,Qt=J(()=>{"use strict";H();fe();Vt();ne();Jt();Ht();Gt();W();Ut();At=ee(te()),U=N(),Rt=class{firstCallableProvider;completionKind;symbolsToQuery;importsByCacheRange;callableProviderCacheScope;constructor(){this.completionKind=void 0,this.symbolsToQuery=U.SymbolFlags.None,this.firstCallableProvider=void 0}update(e){return this.completionKind===void 0&&(this.completionKind=e.contextKind),e.symbolsToQuery!==void 0&&e.symbolsToQuery!==U.SymbolFlags.None&&(this.symbolsToQuery|=e.symbolsToQuery),this.importsByCacheRange===void 0&&typeof e.getImportsByCacheRange=="function"&&(this.importsByCacheRange=e.getImportsByCacheRange()),this.firstCallableProvider===void 0&&e.isCallableProvider!==void 0&&e.isCallableProvider===!0&&(this.firstCallableProvider=e,typeof e.getCallableCacheScope=="function"&&(this.callableProviderCacheScope=e.getCallableCacheScope())),e}getImportsByCacheRange(){return this.importsByCacheRange}getCompletionKind(){return this.completionKind??"none"}getSymbolsToQuery(){return this.symbolsToQuery}isFirstCallableProvider(e){return this.firstCallableProvider===e}getCallableCacheScope(){return this.callableProviderCacheScope}},Nt=class p{static Factories=new Map([[U.SyntaxKind.SourceFile,(e,t,n)=>new $e(t,n)],[U.SyntaxKind.FunctionDeclaration,(e,t,n)=>new ye(e,t,n)],[U.SyntaxKind.ArrowFunction,(e,t,n)=>new ye(e,t,n)],[U.SyntaxKind.FunctionExpression,(e,t,n)=>new ye(e,t,n)],[U.SyntaxKind.ClassDeclaration,Ve.create],[U.SyntaxKind.Constructor,(e,t,n)=>new ze(e,t,n)],[U.SyntaxKind.MethodDeclaration,(e,t,n)=>new Ue(e,t,n)],[U.SyntaxKind.ModuleDeclaration,(e,t,n)=>new Qe(e,t,n)]]);document;tokenInfo;computeInfo;neighborFiles;knownContextItems;constructor(e,t,n,o){this.document=e,this.tokenInfo=t,this.computeInfo=new Rt,this.neighborFiles=n,this.knownContextItems=new Map(o.map(r=>[r.key,r]))}execute(e,t,n,o){let r=[];if(this.neighborFiles!==void 0)for(let l of this.neighborFiles)r.push(U.server.toNormalizedPath(l));let d=new Pe(t,r,this.knownContextItems),a=this.getContextComputeRunnables(t,n,d,o),u=this.computeInfo.getCompletionKind();e.addMetaData(u,At.default.StableSyntaxKinds.getPath(this.tokenInfo.touching??this.tokenInfo.token)),this.executeRunnables(a.getPrimaryRunnables(),e,o),this.executeRunnables(a.getSecondaryRunnables(),e,o),this.executeRunnables(a.getTertiaryRunnables(),e,o),t.addComputationStateItems(e,this.computeInfo)}executeRunnables(e,t,n){for(let o of e){n.throwIfCancellationRequested();try{o.compute(t,n)}catch(r){if(r instanceof A)t.addErrorData(r);else throw r}}}getContextComputeRunnables(e,t,n,o){let r=new Ae;r.addPrimary(new _e(e,t,n,this.document));let d=this.computeProviders();for(let a of d)a.provide(r,e,t,n,o);return r}computeProviders(){let e=[],t=this.tokenInfo.touching;if(t===void 0&&(this.tokenInfo.token===void 0||this.tokenInfo.token.kind===U.SyntaxKind.EndOfFileToken?t=this.tokenInfo.previous:t=this.tokenInfo.token),t===void 0||t.kind===U.SyntaxKind.EndOfFileToken)return e;let n=t;for(;n!==void 0;){let o=p.Factories.get(n.kind);if(o!==void 0){let r=o(n,this.tokenInfo,this.computeInfo);r!==void 0&&e.push(this.computeInfo.update(r))}n=n.parent}return e}}});var Wt,Ye,$t=J(()=>{"use strict";Wt=ee(require("crypto")),Ye=class{constructor(){}createHash(e){return Wt.default.createHash(e)}isDebugging(){return process.execArgv.some(e=>/^--(?:inspect|debug)(?:-brk)?(?:=\d+)?$/i.test(e))}}});var Zt={};mn(Zt,{create:()=>Cn});function Cn(p){if(Yt)return p.languageService;if(p.session!==void 0)try{p.session.addProtocolHandler("_.copilot.ping",()=>({response:Xe,responseRequired:!0}));try{let e=Tn();Xe={kind:"ok",session:!0,supported:e,version:Mt.version},e&&(Se=new Re(p.session,new Ye),Et=p.languageServiceHost,p.session.addProtocolHandler("_.copilot.context",xn))}catch(e){e instanceof Error?(Xe={kind:"error",message:e.message,stack:e.stack},p.session.logError(e,"_.copilot.installHandler")):(Xe={kind:"error",message:"Unknown error"},p.session.logError(new Error("Unknown error"),"_.copilot.installHandler"))}}catch(e){e instanceof Error?p.session.logError(e,"_.copilot.installPingHandler"):p.session.logError(new Error("Unknown error"),"_.copilot.installPingHandler")}finally{Yt=!0}return p.languageService}function Tn(){try{let p=Mt.versionMajorMinor.split(".");if(p.length<2)return!1;let e=parseInt(p[0]),t=parseInt(p[1]);return e>5||e===5&&t>=5}catch{return!1}}var Xt,Mt,Yt,Se,Et,Xe,xn,en=J(()=>{"use strict";Qt();ne();W();Xt=ee(te());H();$t();Mt=N(),Yt=!1,Xe={kind:"error",message:"Attempt to install context handler failed"},xn=p=>{let e=Date.now();if(p.arguments===void 0)return{response:{error:"noArguments",message:"No arguments provided"},responseRequired:!0};let t=p.arguments,n=Se?.getFileAndProject(t);if(n===void 0)return{response:{error:"noProject",message:"No project found"},responseRequired:!0};if(typeof t.line!="number"||typeof t.offset!="number")return{response:{error:"invalidArguments",message:"No project found"},responseRequired:!0};let{file:o,project:r}=n,d=Se?.getPositionInFile(t,o);if(d===void 0)return{response:{error:"invalidPosition",message:"Position not valid"},responseRequired:!0};let a=p.arguments?.startTime??e,u=typeof t.timeBudget=="number"?t.timeBudget:100;a+u>e&&(a=e,u=100);let l=r.getLanguageService();if(l.getProgram()===void 0)return{response:{error:"noProgram",message:"No program found"},responseRequired:!0};let S=Date.now(),x=new Ee(typeof t.tokenBudget=="number"?t.tokenBudget:7*1024),v=t.knownContextItems??[],D=t.computationStates??[],V=new Xt.CancellationTokenWithTimer(Et?.getCancellationToken?Et.getCancellationToken():void 0,a,u,Se?.host.isDebugging()??!1),Q=new Ne(x);try{V.throwIfCancellationRequested(),Se.applyComputationStates(D),zt(Q,Se,l,o,d,t.neighborFiles,v,V)}catch(Y){if(!(Y instanceof Mt.OperationCanceledException)&&!(Y instanceof xe))return Y instanceof Error?{response:{error:"exception",message:Y.message,stack:Y.stack},responseRequired:!0}:{response:{error:"exception",message:"Unknown error"},responseRequired:!0}}let q=Date.now();return Q.addTimings(q-e,q-S),{response:{items:Q.items,timedOut:V.isTimedOut(),tokenBudgetExhausted:x.isExhausted()},responseRequired:!0}}});H();var tn=!1,Lt;function vn(p){if(!tn)try{N.install(p.typescript),Lt=(en(),fn(Zt)).create}finally{tn=!0}if(Lt===void 0)throw new Error("Couldn't initialize TypeScript Context Server Plugin.");return{create:Lt}}module.exports=vn;
